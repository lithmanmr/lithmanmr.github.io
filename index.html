<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C tours E.I.R.L - Cotizador</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#1a365d">
    <meta name="apple-mobile-web-app-status-bar-style" content="#1a365d">
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
    
    <!-- Meta tags PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="C tours">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Meta tags SEO -->
    <meta name="description" content="Cotizador de servicios de movilización y transporte turístico - C tours E.I.R.L. Genera cotizaciones profesionales en PDF.">
    <meta name="keywords" content="C tours, transporte turístico, cotizador, movilización, Ayacucho, Perú">
    <meta name="author" content="C tours E.I.R.L">
    
    <!-- Open Graph (Redes Sociales) -->
    <meta property="og:title" content="C tours E.I.R.L - Cotizador de Servicios">
    <meta property="og:description" content="Agencia de viajes y transporte de turismo en Ayacucho">
    <meta property="og:image" content="assets/android-chrome-512x512.png">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://Ctours.github.io.">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="C tours E.I.R.L - Cotizador de Servicios">
    <meta name="twitter:description" content="Agencia de viajes y transporte de turismo">
    <meta name="twitter:image" content="assets/android-chrome-512x512.png">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a365d;
            --secondary: #2d3748;
            --accent: #d4af37;
            --accent-dark: #b8941f;
            --light: #f7fafc;
            --gray: #e2e8f0;
            --dark: #2d3748;
            --success: #38a169;
            --gold-light: #fef9e7;
            --blue-light: #ebf8ff;
            --green-light: #f0fff4;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 15px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 25px 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            position: relative;
            z-index: 1;
        }
        
        @media (min-width: 768px) {
            .header-content {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
        }
        
        @media (min-width: 768px) {
            .logo {
                justify-content: flex-start;
            }
        }
        
        .logo-icon {
            font-size: 2.2rem;
            color: var(--accent);
        }
        
        .logo-text {
            font-size: 1.6rem;
            font-weight: 700;
            text-align: center;
        }
        
        .tagline {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 5px;
            text-align: center;
        }
        
        .header-contact {
            text-align: center;
        }
        
        @media (min-width: 768px) {
            .header-contact {
                text-align: right;
            }
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 0.9rem;
        }
        
        .contact-link {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .contact-link:hover {
            color: var(--accent);
        }
        
        .form-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (min-width: 768px) {
            .form-container {
                grid-template-columns: 1fr 1fr;
                gap: 25px;
            }
        }
        
        .form-section {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .form-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--gray);
            font-size: 1.2rem;
        }
        
        .section-title i {
            color: var(--accent);
            font-size: 1.2rem;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--secondary);
            font-size: 0.95rem;
        }
        
        .input-with-icon {
            position: relative;
        }
        
        .input-with-icon i {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent);
        }
        
        .input-with-icon input, .input-with-icon select, .input-with-icon textarea {
            padding-left: 40px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--gray);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
            background-color: var(--light);
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--accent);
            outline: none;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
        }
        
        .row {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        @media (min-width: 480px) {
            .row {
                flex-direction: row;
                gap: 12px;
            }
        }
        
        .row .form-group {
            flex: 1;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .checkbox-group input {
            width: auto;
        }
        
        .cost-summary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 25px 20px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            margin-bottom: 25px;
        }
        
        .cost-summary h2 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.4rem;
        }
        
        .cost-summary h2 i {
            color: var(--accent);
        }
        
        .cost-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95rem;
        }
        
        .cost-total {
            display: flex;
            justify-content: space-between;
            padding: 15px 0 0;
            font-size: 1.3rem;
            font-weight: bold;
            margin-top: 12px;
            border-top: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 25px;
        }
        
        @media (min-width: 480px) {
            .actions {
                flex-direction: row;
                justify-content: center;
                gap: 15px;
            }
        }
        
        button {
            padding: 14px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
        }
        
        @media (min-width: 480px) {
            button {
                flex: 0 1 auto;
            }
        }
        
        .btn-primary {
            background-color: var(--accent);
            color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: var(--accent-dark);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        }
        
        .btn-secondary {
            background-color: white;
            color: var(--primary);
            border: 1px solid var(--gray);
        }
        
        .btn-secondary:hover {
            background-color: var(--light);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-accent {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-accent:hover {
            background-color: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(26, 54, 93, 0.4);
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #2f855a;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(56, 161, 105, 0.4);
        }
        
        .hidden {
            display: none;
        }
        
        #pdfPreview {
            margin-top: 30px;
            background-color: white;
            padding: 0;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--gray);
            overflow: hidden;
        }
        
        /* ESTILOS OPTIMIZADOS PARA PDF */
        .pdf-mode .preview-container {
            width: 900px !important;
            max-width: 900px !important;
            min-width: 900px !important;
            padding: 30px !important;
            margin: 0 auto !important;
        }
        
        .preview-container {
            padding: 30px 20px;
            background: white;
            position: relative;
        }
        
        @media (min-width: 768px) {
            .preview-container {
                padding: 40px;
            }
        }
        
        /* Header compacto */
        .pdf-mode .preview-header {
            padding: 15px 20px !important;
            margin: -30px -30px 20px -30px !important;
        }
        
        .pdf-mode .preview-logo-text {
            font-size: 1.3rem !important;
        }
        
        .pdf-mode .preview-company-info {
            font-size: 0.75rem !important;
        }
        
        .preview-header {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 3px solid var(--accent);
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px;
            margin: -30px -20px 30px -20px;
            border-radius: 0;
        }
        
        @media (min-width: 768px) {
            .preview-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: flex-start;
                margin: -40px -40px 40px -40px;
                padding: 25px;
            }
        }
        
        .preview-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
        }
        
        @media (min-width: 768px) {
            .preview-logo {
                justify-content: flex-start;
            }
        }
        
        .preview-logo-icon {
            font-size: 2.2rem;
            color: var(--accent);
        }
        
        .preview-logo-text {
            font-size: 1.6rem;
            font-weight: 700;
            color: white;
            text-align: center;
        }
        
        @media (min-width: 768px) {
            .preview-logo-text {
                text-align: left;
            }
        }
        
        .preview-company-info {
            text-align: center;
            color: rgba(255,255,255,0.9);
            font-size: 0.85rem;
        }
        
        @media (min-width: 768px) {
            .preview-company-info {
                text-align: right;
            }
        }
        
        /* Título compacto */
        .pdf-mode .preview-title {
            padding: 12px !important;
            margin: 15px 0 !important;
        }
        
        .pdf-mode .preview-title h1 {
            font-size: 1.3rem !important;
            margin-bottom: 5px !important;
        }
        
        .pdf-mode .preview-title p {
            font-size: 0.8rem !important;
        }
        
        .pdf-mode .preview-badge {
            font-size: 0.75rem !important;
            padding: 3px 10px !important;
        }
        
        .preview-title {
            text-align: center;
            margin: 25px 0;
            color: var(--primary);
            background: var(--gold-light);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--accent);
        }
        
        .preview-title h1 {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: var(--primary);
        }
        
        .preview-title p {
            font-size: 0.9rem;
            color: var(--secondary);
        }
        
        /* Secciones compactas */
        .pdf-mode .preview-section {
            margin-bottom: 15px !important;
            padding: 15px !important;
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-section-title {
            font-size: 1rem !important;
            margin-bottom: 12px !important;
            padding-bottom: 6px !important;
        }
        
        .pdf-mode .preview-section-title i {
            font-size: 0.9rem !important;
        }
        
        .preview-section {
            margin-bottom: 25px;
            padding: 20px;
            background: var(--light);
            border-radius: 10px;
            border-left: 4px solid var(--accent);
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .preview-section-title {
            color: var(--primary);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
        }
        
        .preview-section-title i {
            color: var(--accent);
        }
        
        /* Filas compactas */
        .pdf-mode .preview-row {
            margin-bottom: 6px !important;
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-label {
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-value {
            font-size: 0.85rem !important;
        }
        
        .preview-row {
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
        }
        
        @media (min-width: 480px) {
            .preview-row {
                flex-direction: row;
            }
        }
        
        .preview-label {
            font-weight: bold;
            width: 100%;
            color: var(--secondary);
            margin-bottom: 4px;
        }
        
        @media (min-width: 480px) {
            .preview-label {
                width: 40%;
                margin-bottom: 0;
            }
        }
        
        .preview-value {
            width: 100%;
        }
        
        @media (min-width: 480px) {
            .preview-value {
                width: 60%;
            }
        }
        
        /* Costos compactos */
        .pdf-mode .preview-costs {
            padding: 15px !important;
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-cost-item {
            padding: 6px 0 !important;
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-cost-total {
            font-size: 1rem !important;
            padding: 10px 0 0 !important;
        }
        
        .preview-costs {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 16px;
            border: 1px solid var(--gray);
            background: linear-gradient(135deg, #fef9e7 0%, #fcf3cf 100%);
        }
        
        .preview-cost-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .preview-cost-total {
            display: flex;
            justify-content: space-between;
            padding: 12px 0 0;
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 12px;
            border-top: 2px solid var(--primary);
            color: var(--primary);
        }
        
        /* Servicios en grid compacto */
        .pdf-mode .preview-services {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 12px !important;
        }
        
        .pdf-mode .service-included,
        .pdf-mode .service-excluded {
            padding: 12px !important;
        }
        
        .pdf-mode .service-title {
            font-size: 0.9rem !important;
            margin-bottom: 8px !important;
        }
        
        .pdf-mode .service-list li {
            font-size: 0.8rem !important;
            margin-bottom: 4px !important;
            padding-left: 15px !important;
        }
        
        .preview-services {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-top: 12px;
        }
        
        @media (min-width: 768px) {
            .preview-services {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .service-included, .service-excluded {
            padding: 18px;
            border-radius: 8px;
        }
        
        .service-included {
            background: var(--green-light);
            border-left: 4px solid var(--success);
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .service-excluded {
            background: #fff5f5;
            border-left: 4px solid #e53e3e;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .service-title {
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 1rem;
        }
        
        .service-included .service-title {
            color: var(--success);
        }
        
        .service-excluded .service-title {
            color: #e53e3e;
        }
        
        .service-list {
            list-style-type: none;
        }
        
        .service-list li {
            margin-bottom: 6px;
            padding-left: 18px;
            position: relative;
            font-size: 0.9rem;
        }
        
        .service-included .service-list li:before {
            content: "✓";
            color: var(--success);
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        .service-excluded .service-list li:before {
            content: "✗";
            color: #e53e3e;
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        /* Recomendaciones compactas */
        .pdf-mode .preview-recommendations {
            padding: 12px !important;
            font-size: 0.8rem !important;
        }
        
        .pdf-mode .preview-recommendations p {
            margin-bottom: 4px !important;
        }
        
        .preview-recommendations {
            background: var(--blue-light);
            padding: 18px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            margin-top: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        /* Servicios adicionales compactos */
        .pdf-mode .preview-additional-services {
            padding: 12px !important;
        }
        
        .pdf-mode .additional-service-item {
            padding: 5px 0 !important;
            font-size: 0.85rem !important;
        }
        
        .preview-footer {
            margin-top: 40px;
            padding-top: 18px;
            border-top: 2px solid var(--accent);
            text-align: center;
            color: var(--secondary);
            background: var(--light);
            padding: 20px;
            border-radius: 10px;
        }
        
        .footer-contact {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 16px 0;
            align-items: center;
        }
        
        @media (min-width: 480px) {
            .footer-contact {
                flex-direction: row;
                justify-content: center;
                gap: 20px;
            }
        }
        
        .footer-contact-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .input-group {
            display: flex;
            align-items: center;
        }
        
        .currency {
            background: var(--primary);
            color: white;
            padding: 12px 12px;
            border-radius: 8px 0 0 8px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .currency-input {
            border-radius: 0 8px 8px 0 !important;
            padding-left: 12px !important;
        }
        
        .notes {
            font-size: 0.85rem;
            color: var(--secondary);
            margin-top: 4px;
            font-style: italic;
        }
        
        .watermark {
            position: absolute;
            bottom: 20px;
            right: 20px;
            opacity: 0.05;
            font-size: 4rem;
            color: var(--primary);
            transform: rotate(-15deg);
            pointer-events: none;
            font-weight: bold;
        }
        
        @media (min-width: 768px) {
            .watermark {
                font-size: 5rem;
                bottom: 30px;
                right: 30px;
            }
        }
        
        .preview-badge {
            background: var(--accent);
            color: var(--primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.85rem;
            display: inline-block;
            margin-bottom: 8px;
        }
        
        .additional-service {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        @media (min-width: 480px) {
            .additional-service {
                flex-direction: row;
                align-items: center;
                gap: 10px;
            }
        }
        
        .additional-service input {
            flex: 1;
        }
        
        .additional-service .cost-input {
            width: 100%;
        }
        
        @media (min-width: 480px) {
            .additional-service .cost-input {
                width: 130px;
            }
        }
        
        .add-service-btn {
            background: var(--success);
            color: white;
            border: none;
            padding: 10px 14px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .remove-service-btn {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .page-number {
            position: absolute;
            bottom: 15px;
            right: 20px;
            color: var(--secondary);
            font-size: 0.8rem;
        }
        
        .pdf-mode .page-number {
            font-size: 0.7rem !important;
        }
        
        .final-page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            min-height: 80vh;
            padding: 40px 20px;
        }
        
        .pdf-mode .final-page {
            min-height: 60vh !important;
            padding: 30px 20px !important;
        }
        
        .pdf-mode .final-message h2 {
            font-size: 1.2rem !important;
        }
        
        .pdf-mode .management-info {
            font-size: 0.85rem !important;
        }
        
        .final-message {
            max-width: 600px;
            margin-bottom: 40px;
        }
        
        .management-info {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--gray);
            width: 100%;
            max-width: 400px;
        }
        
        .management-info p {
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .no-underline {
            text-decoration: none !important;
        }
        
        .preview-additional-services {
            background: #f8f9fa;
            padding: 18px;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
            margin-top: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .preview-additional-services-title {
            color: var(--primary);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
        }
        
        .additional-service-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .additional-service-desc {
            font-weight: 500;
        }
        
        .additional-service-cost {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* Estilos para tablas profesionales */
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9rem;
        }
        
        .preview-table th {
            background-color: var(--primary);
            color: white;
            padding: 10px;
            text-align: left;
            font-weight: 600;
        }
        
        .preview-table td {
            padding: 10px;
            border-bottom: 1px solid var(--gray);
        }
        
        .preview-table tr:nth-child(even) {
            background-color: var(--light);
        }
        
        .preview-table tr:hover {
            background-color: rgba(212, 175, 55, 0.1);
        }
        
        /* Estilos para el logo en PDF */
        .pdf-logo {
            width: 60px;
            height: 60px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--primary);
            border: 2px solid var(--accent);
        }
        
        /* Pie de página en PDF */
        .pdf-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--primary);
            color: white;
            padding: 8px 15px;
            font-size: 0.7rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-map-marked-alt logo-icon"></i>
                    <div>
                        <div class="logo-text">C tours E.I.R.L</div>
                        <div class="tagline">Agencia de viajes y transporte de turismo</div>
                    </div>
                </div>
                <div class="header-contact">
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Portal Constitución 9 - Oficina 3</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <span>+51 992 248 858</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <a href="mailto:info@agenciactours.com" class="contact-link no-underline">agenciactours@gmail.com</a>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-globe"></i>
                        <a href="https://www.agenciactours.com" target="_blank" class="contact-link no-underline">www.agenciactours.com</a>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="form-container">
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-user-circle"></i>
                    Información del Cliente
                </h2>
                
                <div class="form-group">
                    <label for="clientName">Nombre Completo / Empresa</label>
                    <div class="input-with-icon">
                        <i class="fas fa-user"></i>
                        <input type="text" id="clientName" placeholder="Ingresa el nombre completo">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="clientEmail">Correo Electrónico</label>
                    <div class="input-with-icon">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="clientEmail" placeholder="ejemplo@correo.com">
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label for="clientPhone">Teléfono</label>
                        <div class="input-with-icon">
                            <i class="fas fa-phone"></i>
                            <input type="tel" id="clientPhone" placeholder="Número de contacto">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="clientDni">DNI / Pasaporte</label>
                        <div class="input-with-icon">
                            <i class="fas fa-id-card"></i>
                            <input type="text" id="clientDni" placeholder="Número de documento">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="clientAddress">Dirección</label>
                    <div class="input-with-icon">
                        <i class="fas fa-home"></i>
                        <textarea id="clientAddress" rows="2" placeholder="Dirección completa"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-route"></i>
                    Detalles del Servicio
                </h2>
                
                <div class="form-group">
                    <label for="serviceType">Tipo de Servicio</label>
                    <div class="input-with-icon">
                        <i class="fas fa-car-side"></i>
                        <select id="serviceType">
                            <option value="transfer">Transfer Aeropuerto/Hotel</option>
                            <option value="city">Tour Ciudad</option>
                            <option value="intercity">Transporte Interurbano</option>
                            <option value="school">Viaje de Estudios</option>
                            <option value="corporate">Servicio Corporativo</option>
                            <option value="event">Transporte para Eventos</option>
                            <option value="custom">Servicio Personalizado</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="vehicleType">Tipo de Vehículo</label>
                    <div class="input-with-icon">
                        <i class="fas fa-bus"></i>
                        <select id="vehicleType">
                            <option value="sedan">Sedán</option>
                            <option value="suv">SUV</option>
                            <option value="pick">Pick Up / Camioneta</option>
                            <option value="van">Van</option>
                            <option value="minivan">Mini Van</option>
                            <option value="minibus">Minibús</option>
                            <option value="bus">Autobús</option>
                        </select>
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label for="startDate">Fecha de Ida</label>
                        <div class="input-with-icon">
                            <i class="fas fa-calendar-alt"></i>
                            <input type="date" id="startDate">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="endDate">Fecha de Vuelta</label>
                        <div class="input-with-icon">
                            <i class="fas fa-calendar-alt"></i>
                            <input type="date" id="endDate">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="destination">Lugar / Destino</label>
                    <div class="input-with-icon">
                        <i class="fas fa-map-marker-alt"></i>
                        <input type="text" id="destination" placeholder="Destino del viaje">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="form-container">
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-calculator"></i>
                    Configuración de Costos
                </h2>
                
                <div class="form-group">
                    <label for="costPerPassenger">Costo por Pasajero (S/)</label>
                    <div class="input-group">
                        <div class="currency">S/</div>
                        <input type="number" id="costPerPassenger" min="0" step="0.01" value="0.00" class="currency-input">
                    </div>
                    <div class="notes">Precio base por persona para el servicio</div>
                </div>
                
                <div class="form-group">
                    <label for="passengers">Número de Pasajeros</label>
                    <div class="input-with-icon">
                        <i class="fas fa-users"></i>
                        <input type="number" id="passengers" min="1" value="1">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="discount">Descuento (%)</label>
                    <div class="input-with-icon">
                        <i class="fas fa-tag"></i>
                        <input type="number" id="discount" min="0" max="100" value="0">
                    </div>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="includeIgv" checked>
                    <label for="includeIgv">Incluir IGV (18%)</label>
                </div>
            </div>
            
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-plus-circle"></i>
                    Servicios Adicionales
                </h2>
                
                <div id="additionalServicesContainer">
                </div>
                
                <button type="button" class="add-service-btn" onclick="addService()">
                    <i class="fas fa-plus"></i> Agregar Servicio Adicional
                </button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="includedServices">Servicios Incluidos</label>
                    <textarea id="includedServices" rows="4" placeholder="Lista de servicios incluidos (uno por línea)"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="excludedServices">Servicios No Incluidos</label>
                    <textarea id="excludedServices" rows="4" placeholder="Lista de servicios no incluidos (uno por línea)"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="recommendations">Recomendaciones</label>
                    <textarea id="recommendations" rows="4" placeholder="Recomendaciones para el cliente (una por línea)"></textarea>
                </div>
            </div>
        </div>
        
        <div class="cost-summary">
            <h2>
                <i class="fas fa-file-invoice-dollar"></i>
                Resumen de Costos
            </h2>
            
            <div class="cost-item">
                <span>Costo Base:</span>
                <span id="baseCost">S/ 0.00</span>
            </div>
            
            <div class="cost-item" id="additionalServicesCostItem" style="display: none;">
                <span>Servicios Adicionales:</span>
                <span id="additionalServicesCost">S/ 0.00</span>
            </div>
            
            <div class="cost-item">
                <span>Descuento:</span>
                <span id="discountDisplay">S/ 0.00</span>
            </div>
            
            <div class="cost-item" id="taxItem">
                <span>IGV (18%):</span>
                <span id="taxCost">S/ 0.00</span>
            </div>
            
            <div class="cost-total">
                <span>Total a Pagar:</span>
                <span id="totalCost">S/ 0.00</span>
            </div>
        </div>
        
        <div class="actions">
            <button class="btn-secondary" id="resetBtn">
                <i class="fas fa-undo"></i>
                Limpiar Formulario
            </button>
            <button class="btn-primary" id="previewBtn">
                <i class="fas fa-eye"></i>
                Vista Previa
            </button>
            <button class="btn-accent" id="generatePdfBtn">
                <i class="fas fa-file-pdf"></i>
                Generar PDF
            </button>

            <button class="btn-success hidden" id="sharePdfBtn">
                <i class="fas fa-share-alt"></i>
                Compartir PDF
    </button>
        </div>
        
        <div id="pdfPreview" class="hidden">
            <div class="preview-container" id="page1">
                <div class="watermark">C TOURS</div>
                
                <div class="preview-header">
                    <div class="preview-logo">
                        <div class="pdf-logo">CT</div>
                        <div class="preview-logo-text">C tours E.I.R.L</div>
                    </div>
                    <div class="preview-company-info">
                        <div>Portal Constitución 9 - Oficina 3, Ayacucho</div>
                        <div>+51 992 248 858 | agenciactours@gmail.com</div>
                        <div>www.agenciactours.com</div>
                    </div>
                </div>
                
                <div class="preview-title">
                    <h1>COTIZACIÓN DE SERVICIOS DE MOVILIZACIÓN</h1>
                    <p>Fecha de emisión: <span id="previewDate"></span> | Válida por 15 días</p>
                    <div class="preview-badge">COTIZACIÓN #<span id="quoteNumber">001</span></div>
                </div>
                
                <div class="preview-section">
                    <h3 class="preview-section-title">
                        <i class="fas fa-user-circle"></i>
                        Información del Cliente
                    </h3>
                    <table class="preview-table">
                        <tr>
                            <td width="30%"><strong>Nombre Completo:</strong></td>
                            <td id="previewClientName"></td>
                        </tr>
                        <tr>
                            <td><strong>Correo Electrónico:</strong></td>
                            <td id="previewClientEmail"></td>
                        </tr>
                        <tr>
                            <td><strong>Teléfono:</strong></td>
                            <td id="previewClientPhone"></td>
                        </tr>
                        <tr>
                            <td><strong>DNI/Pasaporte:</strong></td>
                            <td id="previewClientDni"></td>
                        </tr>
                        <tr>
                            <td><strong>Dirección:</strong></td>
                            <td id="previewClientAddress"></td>
                        </tr>
                    </table>
                </div>
                
                <div class="preview-section">
                    <h3 class="preview-section-title">
                        <i class="fas fa-route"></i>
                        Detalles del Servicio
                    </h3>
                    <table class="preview-table">
                        <tr>
                            <td width="30%"><strong>Tipo de Servicio:</strong></td>
                            <td id="previewServiceType"></td>
                        </tr>
                        <tr>
                            <td><strong>Vehículo:</strong></td>
                            <td id="previewVehicleType"></td>
                        </tr>
                        <tr>
                            <td><strong>Fecha de Ida:</strong></td>
                            <td id="previewStartDate"></td>
                        </tr>
                        <tr>
                            <td><strong>Fecha de Vuelta:</strong></td>
                            <td id="previewEndDate"></td>
                        </tr>
                        <tr>
                            <td><strong>Lugar / Destino:</strong></td>
                            <td id="previewDestination"></td>
                        </tr>
                    </table>
                </div>
                
                <div class="pdf-footer">
                    C tours | +51 992 248 858 | www.agenciactours.com
                </div>
                <div class="page-number">Página 1 de 3</div>
            </div>
            
            <div class="preview-container" id="page2">
                <div class="watermark">C TOURS</div>
                
                <div class="preview-header">
                    <div class="preview-logo">
                        <div class="pdf-logo">CT</div>
                        <div class="preview-logo-text">C tours E.I.R.L</div>
                    </div>
                    <div class="preview-company-info">
                        <div>Portal Constitución 9 - Oficina 3, Ayacucho</div>
                        <div>+51 992 248 858 | agenciactours@gmail.com</div>
                        <div>www.agenciactours.com</div>
                    </div>
                </div>
                
                <div class="preview-section" id="previewAdditionalServicesSection" style="display: none;">
                    <h3 class="preview-section-title">
                        <i class="fas fa-plus-circle"></i>
                        Servicios Adicionales
                    </h3>
                    <div class="preview-additional-services" id="previewAdditionalServicesList">
                    </div>
                </div>
                
                <div class="preview-section">
                    <h3 class="preview-section-title">
                        <i class="fas fa-file-invoice-dollar"></i>
                        Resumen de Costos
                    </h3>
                    <table class="preview-table">
                        <tr>
                            <td width="70%"><strong>Costo Base:</strong></td>
                            <td id="previewBaseCost"></td>
                        </tr>
                        <tr id="previewAdditionalServicesItem" style="display: none;">
                            <td><strong>Servicios Adicionales:</strong></td>
                            <td id="previewAdditionalServicesCost"></td>
                        </tr>
                        <tr>
                            <td><strong>Descuento:</strong></td>
                            <td id="previewDiscount"></td>
                        </tr>
                        <tr>
                            <td><strong>Subtotal:</strong></td>
                            <td id="previewSubtotal"></td>
                        </tr>
                        <tr id="previewTaxItem">
                            <td><strong>IGV (18%):</strong></td>
                            <td id="previewTax"></td>
                        </tr>
                        <tr style="background-color: var(--accent); color: white; font-weight: bold;">
                            <td><strong>TOTAL A PAGAR:</strong></td>
                            <td id="previewTotalCost"></td>
                        </tr>
                    </table>
                </div>
                
                <div class="preview-section">
                    <h3 class="preview-section-title">
                        <i class="fas fa-clipboard-check"></i>
                        Servicios Incluidos y No Incluidos
                    </h3>
                    <div class="preview-services">
                        <div class="service-included">
                            <div class="service-title">
                                <i class="fas fa-check-circle"></i>
                                Servicios Incluidos
                            </div>
                            <ul class="service-list" id="previewIncludedServices">
                            </ul>
                        </div>
                        <div class="service-excluded">
                            <div class="service-title">
                                <i class="fas fa-times-circle"></i>
                                Servicios No Incluidos
                            </div>
                            <ul class="service-list" id="previewExcludedServices">
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="preview-section">
                    <h3 class="preview-section-title">
                        <i class="fas fa-lightbulb"></i>
                        Recomendaciones
                    </h3>
                    <div class="preview-recommendations" id="previewRecommendations">
                    </div>
                </div>
                
                <div class="pdf-footer">
                    C tours | +51 992 248 858 | www.agenciactours.com
                </div>
                <div class="page-number">Página 2 de 3</div>
            </div>
            
            <div class="preview-container" id="page3">
                <div class="watermark">C TOURS</div>
                
                <div class="preview-header">
                    <div class="preview-logo">
                        <div class="pdf-logo">CT</div>
                        <div class="preview-logo-text">C tours E.I.R.L</div>
                    </div>
                    <div class="preview-company-info">
                        <div>Portal Constitución 9 - Oficina 3, Ayacucho</div>
                        <div>+51 992 248 858 | agenciactours@gmail.com</div>
                        <div>www.agenciactours.com</div>
                    </div>
                </div>
                
                <div class="preview-section">
                    <h3 class="preview-section-title">
                        <i class="fas fa-sticky-note"></i>
                        Términos y Condiciones
                    </h3>
                    <p>• Esta cotización es válida por 15 días a partir de la fecha de emisión.</p>
                    <p>• Para confirmar el servicio, se requiere un anticipo del 50% del valor total.</p>
                    <p>• El pago restante debe realizarse al momento de la prestación del servicio.</p>
                    <p>• Cualquier cambio en el itinerario puede afectar el costo final.</p>
                    <p>• Los precios no incluyen propinas para el conductor o guías.</p>
                    <p>• La empresa se reserva el derecho de modificar vehículos por otros de similar categoría.</p>
                </div>
                
                <div class="final-page">
                    <div class="final-message">
                        <h2>¡Gracias por preferir nuestros servicios!</h2>
                        <p>Estamos comprometidos con brindarle una experiencia de movilización segura y confortable.</p>
                    </div>
                    
                    <div class="management-info">
                        <p><strong>Gerente General</strong></p>
                        <p>César De la Cruz Vilcapoma</p>
                        <p>DNI: 74039078</p>
                        <p>RUC: 20603243251</p>
                        <p>Agencia de Viajes y Transportes de Turismo C tours E.I.R.L</p>
                    </div>
                </div>
                
                <div class="pdf-footer">
                    C tours | +51 992 248 858 | www.agenciactours.com
                </div>
                <div class="page-number">Página 3 de 3</div>
            </div>
        </div>
    </div>

    <script>
        const { jsPDF } = window.jspdf;
        
        const clientName = document.getElementById('clientName');
        const clientEmail = document.getElementById('clientEmail');
        const clientPhone = document.getElementById('clientPhone');
        const clientDni = document.getElementById('clientDni');
        const clientAddress = document.getElementById('clientAddress');
        const serviceType = document.getElementById('serviceType');
        const vehicleType = document.getElementById('vehicleType');
        const startDate = document.getElementById('startDate');
        const endDate = document.getElementById('endDate');
        const destination = document.getElementById('destination');
        const costPerPassenger = document.getElementById('costPerPassenger');
        const passengers = document.getElementById('passengers');
        const discount = document.getElementById('discount');
        const includeIgv = document.getElementById('includeIgv');
        const includedServices = document.getElementById('includedServices');
        const excludedServices = document.getElementById('excludedServices');
        const recommendations = document.getElementById('recommendations');
        const additionalServicesContainer = document.getElementById('additionalServicesContainer');
        
        const baseCostEl = document.getElementById('baseCost');
        const additionalServicesCostEl = document.getElementById('additionalServicesCost');
        const additionalServicesCostItem = document.getElementById('additionalServicesCostItem');
        const discountDisplayEl = document.getElementById('discountDisplay');
        const taxCostEl = document.getElementById('taxCost');
        const totalCostEl = document.getElementById('totalCost');
        const taxItem = document.getElementById('taxItem');
        
        const resetBtn = document.getElementById('resetBtn');
        const previewBtn = document.getElementById('previewBtn');
        const generatePdfBtn = document.getElementById('generatePdfBtn');
        const sharePdfBtn = document.getElementById('sharePdfBtn');

        let currentPdfBlob = null;
        let currentPdfName = null;
        
        const pdfPreview = document.getElementById('pdfPreview');
        const previewDate = document.getElementById('previewDate');
        const quoteNumber = document.getElementById('quoteNumber');
        const previewClientName = document.getElementById('previewClientName');
        const previewClientEmail = document.getElementById('previewClientEmail');
        const previewClientPhone = document.getElementById('previewClientPhone');
        const previewClientDni = document.getElementById('previewClientDni');
        const previewClientAddress = document.getElementById('previewClientAddress');
        const previewServiceType = document.getElementById('previewServiceType');
        const previewVehicleType = document.getElementById('previewVehicleType');
        const previewStartDate = document.getElementById('previewStartDate');
        const previewEndDate = document.getElementById('previewEndDate');
        const previewDestination = document.getElementById('previewDestination');
        const previewBaseCost = document.getElementById('previewBaseCost');
        const previewAdditionalServicesCost = document.getElementById('previewAdditionalServicesCost');
        const previewAdditionalServicesItem = document.getElementById('previewAdditionalServicesItem');
        const previewDiscount = document.getElementById('previewDiscount');
        const previewSubtotal = document.getElementById('previewSubtotal');
        const previewTax = document.getElementById('previewTax');
        const previewTaxItem = document.getElementById('previewTaxItem');
        const previewTotalCost = document.getElementById('previewTotalCost');
        const previewIncludedServices = document.getElementById('previewIncludedServices');
        const previewExcludedServices = document.getElementById('previewExcludedServices');
        const previewRecommendations = document.getElementById('previewRecommendations');
        
        const previewAdditionalServicesSection = document.getElementById('previewAdditionalServicesSection');
        const previewAdditionalServicesList = document.getElementById('previewAdditionalServicesList');
        
        const taxRate = 0.18;
        
        function addService() {
            const serviceDiv = document.createElement('div');
            serviceDiv.className = 'additional-service';
            serviceDiv.innerHTML = `
                <input type="text" placeholder="Descripción del servicio adicional" class="service-desc">
                <div class="input-group">
                    <div class="currency">S/</div>
                    <input type="number" min="0" step="0.01" value="0.00" class="currency-input service-cost">
                </div>
                <button type="button" class="remove-service-btn" onclick="removeService(this)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            additionalServicesContainer.appendChild(serviceDiv);
            
            const costInput = serviceDiv.querySelector('.service-cost');
            const descInput = serviceDiv.querySelector('.service-desc');
            
            costInput.addEventListener('input', calculateCosts);
            descInput.addEventListener('input', updatePreviewServices);
            
            calculateCosts();
        }
        
        function removeService(button) {
            button.parentElement.remove();
            calculateCosts();
            updatePreviewServices();
        }
        
        function getAdditionalServices() {
            const services = [];
            const serviceElements = additionalServicesContainer.querySelectorAll('.additional-service');
            
            serviceElements.forEach(element => {
                const desc = element.querySelector('.service-desc').value;
                const cost = parseFloat(element.querySelector('.service-cost').value) || 0;
                
                if (desc.trim() !== '') {
                    services.push({
                        description: desc.trim(),
                        cost: cost
                    });
                }
            });
            
            return services;
        }
        
        function calculateCosts() {
            const costPerPerson = parseFloat(costPerPassenger.value) || 0;
            const numPassengers = parseInt(passengers.value) || 0;
            const discountPercent = parseFloat(discount.value) || 0;
            const additionalServices = getAdditionalServices();
            
            let baseCost = costPerPerson * numPassengers;
            let additionalCost = additionalServices.reduce((sum, service) => sum + service.cost, 0);
            let discountAmount = baseCost * (discountPercent / 100);
            let subtotal = baseCost + additionalCost - discountAmount;
            
            let taxAmount = 0;
            let totalCost = subtotal;
            
            if (includeIgv.checked) {
                taxAmount = subtotal * taxRate;
                totalCost = subtotal + taxAmount;
            }
            
            baseCostEl.textContent = `S/ ${baseCost.toFixed(2)}`;
            additionalServicesCostEl.textContent = `S/ ${additionalCost.toFixed(2)}`;
            discountDisplayEl.textContent = `S/ ${discountAmount.toFixed(2)}`;
            taxCostEl.textContent = `S/ ${taxAmount.toFixed(2)}`;
            totalCostEl.textContent = `S/ ${totalCost.toFixed(2)}`;
            
            if (includeIgv.checked) {
                taxItem.style.display = 'flex';
            } else {
                taxItem.style.display = 'none';
            }
            
            if (additionalCost > 0) {
                additionalServicesCostItem.style.display = 'flex';
            } else {
                additionalServicesCostItem.style.display = 'none';
            }
            
            return {
                baseCost,
                additionalCost,
                discountAmount,
                subtotal,
                taxAmount,
                totalCost
            };
        }
        
        function showPreview() {
            if (!clientName.value || !serviceType.value || !startDate.value || !endDate.value) {
                alert('Por favor, complete todos los campos requeridos.');
                return;
            }
            
            const costs = calculateCosts();
            
            const today = new Date();
            const quoteNum = today.getFullYear().toString().slice(-2) + 
                           (today.getMonth()+1).toString().padStart(2, '0') + 
                           today.getDate().toString().padStart(2, '0') + 
                           Math.floor(Math.random() * 100).toString().padStart(2, '0');
            quoteNumber.textContent = quoteNum;
            
            previewDate.textContent = today.toLocaleDateString('es-ES');
            previewClientName.textContent = clientName.value || 'No especificado';
            previewClientEmail.textContent = clientEmail.value || 'No especificado';
            previewClientPhone.textContent = clientPhone.value || 'No especificado';
            previewClientDni.textContent = clientDni.value || 'No especificado';
            previewClientAddress.textContent = clientAddress.value || 'No especificado';
            previewServiceType.textContent = getServiceTypeText(serviceType.value);
            previewVehicleType.textContent = getVehicleTypeText(vehicleType.value);
            previewStartDate.textContent = formatDate(startDate.value);
            previewEndDate.textContent = formatDate(endDate.value);
            previewDestination.textContent = destination.value || 'Por definir con el cliente';
            
            previewBaseCost.textContent = `S/ ${costs.baseCost.toFixed(2)}`;
            previewAdditionalServicesCost.textContent = `S/ ${costs.additionalCost.toFixed(2)}`;
            previewDiscount.textContent = `S/ ${costs.discountAmount.toFixed(2)}`;
            previewSubtotal.textContent = `S/ ${costs.subtotal.toFixed(2)}`;
            previewTax.textContent = `S/ ${costs.taxAmount.toFixed(2)}`;
            previewTotalCost.textContent = `S/ ${costs.totalCost.toFixed(2)}`;
            
            if (costs.additionalCost > 0) {
                previewAdditionalServicesItem.style.display = 'table-row';
            } else {
                previewAdditionalServicesItem.style.display = 'none';
            }
            
            if (includeIgv.checked) {
                previewTaxItem.style.display = 'table-row';
            } else {
                previewTaxItem.style.display = 'none';
            }
            
            updateServiceDetails();
            updatePreviewServices();
            
            pdfPreview.classList.remove('hidden');
            pdfPreview.scrollIntoView({ behavior: 'smooth' });
        }
        
        function updatePreviewServices() {
            const additionalServices = getAdditionalServices();
            
            previewAdditionalServicesList.innerHTML = '';
            
            if (additionalServices.length > 0) {
                previewAdditionalServicesSection.style.display = 'block';
                
                additionalServices.forEach(service => {
                    const serviceItem = document.createElement('div');
                    serviceItem.className = 'additional-service-item';
                    serviceItem.innerHTML = `
                        <div class="additional-service-desc">${service.description}</div>
                        <div class="additional-service-cost">S/ ${service.cost.toFixed(2)}</div>
                    `;
                    previewAdditionalServicesList.appendChild(serviceItem);
                });
            } else {
                previewAdditionalServicesSection.style.display = 'none';
            }
        }
        
        function updateServiceDetails() {
            previewIncludedServices.innerHTML = '';
            previewExcludedServices.innerHTML = '';
            previewRecommendations.innerHTML = '';
            
            const includedList = includedServices.value.split('\n').filter(item => item.trim() !== '');
            includedList.forEach(service => {
                const li = document.createElement('li');
                li.textContent = service.trim();
                previewIncludedServices.appendChild(li);
            });
            
            const excludedList = excludedServices.value.split('\n').filter(item => item.trim() !== '');
            excludedList.forEach(service => {
                const li = document.createElement('li');
                li.textContent = service.trim();
                previewExcludedServices.appendChild(li);
            });
            
            const recList = recommendations.value.split('\n').filter(item => item.trim() !== '');
            recList.forEach(rec => {
                const p = document.createElement('p');
                p.textContent = `• ${rec.trim()}`;
                previewRecommendations.appendChild(p);
            });
        }
        
        async function generatePDF() {
            if (!clientName.value || !serviceType.value || !startDate.value || !endDate.value) {
                alert('Por favor, complete todos los campos requeridos antes de generar el PDF.');
                return;
            }
            
            const doc = new jsPDF();

            const logoPath = 'assets/logo.png';
            
            // Colores corporativos
            const grisElegante = [245, 245, 245];  // Casi blanco, muy elegante
            const azulOscuro = [26, 54, 93];
            const dorado = [212, 175, 55];
            const gris = [100, 100, 100];
            
            let y = 20;
            
            // ========== ENCABEZADO PREMIUM ==========
            doc.setFillColor(...azulOscuro);
            doc.rect(0, 0, 210, 50, 'F');
            
            // Logo
            const img = new Image();
            img.src = logoPath;
            
            // Una vez que la imagen esté cargada, generar el PDF
            img.onload = function() {
                // Agregar el logo (ajusta las coordenadas y tamaño según necesites)
                doc.addImage(img, 'PNG', -3, -14, 80, 80);

            
            
            // Nombre de la empresa
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(24);
            doc.setFont(undefined, 'bold');
            doc.text('C tours E.I.R.L', 105, 23, { align: 'center' });
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('Agencia de viajes y transporte de turismo', 105, 32, { align: 'center' });
            
            // Datos de contacto
            doc.setFontSize(8);
            const contacto = [
                'Portal Constitución 9 - Oficina 3, Ayacucho',
                '+51 992 248 858',
                'agenciactours@gmail.com',
                'www.agenciactours.com'
            ];
            let yContacto = 15;
            contacto.forEach(dato => {
                doc.text(dato, 205, yContacto, { align: 'right' });
                yContacto += 4;
            });
            
            y = 60;
            
            // Título de cotización
            doc.setFillColor(240, 240, 240);
            doc.rect(15, y, 180, 12, 'F');
            doc.setTextColor(...azulOscuro);
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('COTIZACIÓN DE SERVICIOS DE MOVILIZACIÓN', 105, y + 8, { align: 'center' });
            
            y += 18;
            
            doc.setFontSize(9);
            doc.setFont(undefined, 'normal');
            doc.setTextColor(...gris);
            const fecha = new Date().toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' });
            const quoteNum = new Date().getFullYear().toString().slice(-2) + 
                           (new Date().getMonth()+1).toString().padStart(2, '0') + 
                           new Date().getDate().toString().padStart(2, '0') + 
                           Math.floor(Math.random() * 100).toString().padStart(2, '0');
            doc.text(`Fecha de emisión: ${fecha}`, 15, y);
            doc.text(`Cotización N°: ${quoteNum}`, 195, y, { align: 'right' });
            doc.text('Válida por 15 días', 105, y + 5, { align: 'center' });
            
            y += 12;
            
            // ========== INFORMACIÓN DEL CLIENTE ==========
            doc.setFillColor(...dorado);
            doc.rect(15, y, 180, 8, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('INFORMACIÓN DEL CLIENTE', 20, y + 5.5);
            
            y += 14;
            doc.setTextColor(50, 50, 50);
            doc.setFontSize(10);
            
            const clienteData = [
                ['Nombre:', clientName.value || 'No especificado'],
                ['Correo:', clientEmail.value || 'No especificado'],
                ['Teléfono:', clientPhone.value || 'No especificado'],
                ['DNI/Pasaporte:', clientDni.value || 'No especificado'],
                ['Dirección:', clientAddress.value || 'No especificado']
            ];
            
            clienteData.forEach(([label, valor]) => {
                doc.setFont(undefined, 'bold');
                doc.text(label, 20, y);
                doc.setFont(undefined, 'normal');
                const textoValor = doc.splitTextToSize(valor, 120);
                doc.text(textoValor, 55, y);
                y += Math.max(6, textoValor.length * 5);
            });
            
            y += 5;
            
            // ========== DETALLES DEL SERVICIO ==========
            doc.setFillColor(...dorado);
            doc.rect(15, y, 180, 8, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('DETALLES DEL SERVICIO', 20, y + 5.5);
            
            y += 14;
            doc.setTextColor(50, 50, 50);
            doc.setFontSize(10);
            
            const servicioData = [
                ['Tipo de Servicio:', getServiceTypeText(serviceType.value)],
                ['Vehículo:', getVehicleTypeText(vehicleType.value)],
                ['Fecha de Ida:', formatDate(startDate.value)],
                ['Fecha de Vuelta:', formatDate(endDate.value)],
                ['Destino:', destination.value || 'Por definir con el cliente']
            ];
            
            servicioData.forEach(([label, valor]) => {
                doc.setFont(undefined, 'bold');
                doc.text(label, 20, y);
                doc.setFont(undefined, 'normal');
                const textoValor = doc.splitTextToSize(valor, 120);
                doc.text(textoValor, 55, y);
                y += Math.max(6, textoValor.length * 5);
            });
            
            y += 8;
            
            // Pie de página para la primera página
            doc.setFillColor(...azulOscuro);
            doc.rect(0, 277, 210, 20, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(8);
            doc.setFont(undefined, 'normal');
            doc.text('C tours | +51 992 248 858 | www.agenciactours.com', 105, 285, { align: 'center' });
            doc.text('Página 1 de 3', 195, 285, { align: 'right' });
            
            // ========== NUEVA PÁGINA ==========
            doc.addPage();
            y = 20;
            
            // Encabezado página 2
            doc.setFillColor(...azulOscuro);
            doc.rect(0, 0, 210, 30, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text('C tours E.I.R.L', 105, 20, { align: 'center' });
            
            y = 40;
            
            // ========== SERVICIOS ADICIONALES ==========
            const additionalServices = getAdditionalServices();
            if (additionalServices.length > 0) {
                doc.setFillColor(...dorado);
                doc.rect(15, y, 180, 8, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(11);
                doc.setFont(undefined, 'bold');
                doc.text('SERVICIOS ADICIONALES', 20, y + 5.5);
                
                y += 14;
                doc.setTextColor(50, 50, 50);
                doc.setFontSize(10);
                
                additionalServices.forEach(service => {
                    doc.setFont(undefined, 'normal');
                    const desc = doc.splitTextToSize(`• ${service.description}`, 140);
                    doc.text(desc, 20, y);
                    doc.setFont(undefined, 'bold');
                    doc.text(`S/ ${service.cost.toFixed(2)}`, 195, y, { align: 'right' });
                    y += Math.max(6, desc.length * 5);
                });
                
                y += 8;
            }
            
            // ========== RESUMEN DE COSTOS ==========
            const costs = calculateCosts();
            
            doc.setFillColor(...dorado);
            doc.rect(15, y, 180, 8, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('RESUMEN DE COSTOS', 20, y + 5.5);
            
            y += 14;
            doc.setTextColor(50, 50, 50);
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            
            doc.text('Costo Base:', 20, y);
            doc.text(`S/ ${costs.baseCost.toFixed(2)}`, 195, y, { align: 'right' });
            y += 6;
            
            if (costs.additionalCost > 0) {
                doc.text('Servicios Adicionales:', 20, y);
                doc.text(`S/ ${costs.additionalCost.toFixed(2)}`, 195, y, { align: 'right' });
                y += 6;
            }
            
            doc.text('Descuento:', 20, y);
            doc.text(`- S/ ${costs.discountAmount.toFixed(2)}`, 195, y, { align: 'right' });
            y += 6;
            
            doc.text('Subtotal:', 20, y);
            doc.text(`S/ ${costs.subtotal.toFixed(2)}`, 195, y, { align: 'right' });
            y += 6;
            
            if (includeIgv.checked) {
                doc.text('IGV (18%):', 20, y);
                doc.text(`S/ ${costs.taxAmount.toFixed(2)}`, 195, y, { align: 'right' });
                y += 6;
            }
            
            y += 4;
            doc.setFillColor(240, 240, 240);
            doc.rect(15, y - 3, 180, 12, 'F');
            doc.setTextColor(...azulOscuro);
            doc.setFontSize(13);
            doc.setFont(undefined, 'bold');
            doc.text('TOTAL A PAGAR:', 20, y + 5);
            doc.text(`S/ ${costs.totalCost.toFixed(2)}`, 195, y + 5, { align: 'right' });
            
            y += 18;
            
            // ========== SERVICIOS INCLUIDOS/NO INCLUIDOS ==========
            const includedList = includedServices.value.split('\n').filter(item => item.trim() !== '');
            const excludedList = excludedServices.value.split('\n').filter(item => item.trim() !== '');

            // SOLO MOSTRAR ESTA SECCIÓN SI HAY CONTENIDO
            if (includedList.length > 0 || excludedList.length > 0) {
                doc.setFillColor(...dorado);
                doc.rect(15, y, 180, 8, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(11);
                doc.setFont(undefined, 'bold');
                doc.text('SERVICIOS INCLUIDOS Y NO INCLUIDOS', 20, y + 5.5);
                
                y += 14;
                doc.setTextColor(50, 50, 50);
                doc.setFontSize(9);
                
                if (includedList.length > 0) {
                    doc.setFont(undefined, 'bold');
                    doc.setTextColor(56, 161, 105);
                    doc.text('Incluidos:', 20, y);
                    y += 5;
                    doc.setFont(undefined, 'normal');
                    doc.setTextColor(50, 50, 50);
                    includedList.forEach(item => {
                        const lines = doc.splitTextToSize(`• ${item.trim()}`, 80);
                        doc.text(lines, 20, y);
                        y += lines.length * 4;
                    });
                }
                
                y += 3;
                if (excludedList.length > 0) {
                    doc.setFont(undefined, 'bold');
                    doc.setTextColor(229, 62, 62);
                    doc.text('No Incluidos:', 110, y - (includedList.length * 4) - 5);
                    doc.setFont(undefined, 'normal');
                    doc.setTextColor(50, 50, 50);
                    let yExcluded = y - (includedList.length * 4);
                    excludedList.forEach(item => {
                        const lines = doc.splitTextToSize(`• ${item.trim()}`, 80);
                        doc.text(lines, 110, yExcluded);
                        yExcluded += lines.length * 4;
                    });
                    y = Math.max(y, yExcluded);
                }
                
                y += 8;
            }
            
            // ========== RECOMENDACIONES ==========
            const recList = recommendations.value.split('\n').filter(item => item.trim() !== '');
            if (recList.length > 0) {
                doc.setFillColor(...dorado);
                doc.rect(15, y, 180, 8, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(11);
                doc.setFont(undefined, 'bold');
                doc.text('RECOMENDACIONES', 20, y + 5.5);
                
                y += 14;
                doc.setTextColor(50, 50, 50);
                doc.setFontSize(9);
                doc.setFont(undefined, 'normal');
                
                recList.forEach(rec => {
                    const lines = doc.splitTextToSize(`• ${rec.trim()}`, 170);
                    doc.text(lines, 20, y);
                    y += lines.length * 4.5;
                });
            }
            
            // Pie de página para la segunda página
            doc.setFillColor(...azulOscuro);
            doc.rect(0, 277, 210, 20, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(8);
            doc.setFont(undefined, 'normal');
            doc.text('C tours | +51 992 248 858 | www.agenciactours.com', 105, 285, { align: 'center' });
            doc.text('Página 2 de 3', 195, 285, { align: 'right' });
            
            // ========== PÁGINA 3 - TÉRMINOS ==========
            doc.addPage();
            y = 20;
            
            // Encabezado página 3
            doc.setFillColor(...azulOscuro);
            doc.rect(0, 0, 210, 30, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text('C tours E.I.R.L', 105, 20, { align: 'center' });
            
            y = 50;
            
            // ========== TÉRMINOS Y CONDICIONES ==========
            doc.setFillColor(...dorado);
            doc.rect(15, y, 180, 8, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('TÉRMINOS Y CONDICIONES', 20, y + 5.5);
            
            y += 14;
            doc.setTextColor(50, 50, 50);
            doc.setFontSize(9);
            doc.setFont(undefined, 'normal');
            
            const terminos = [
                '• Esta cotización es válida por 15 días a partir de la fecha de emisión.',
                '• Para confirmar el servicio, se requiere un anticipo del 50% del valor total.',
                '• El pago restante debe realizarse al momento de la prestación del servicio.',
                '• Cualquier cambio en el itinerario puede afectar el costo final.',
                '• La empresa se reserva el derecho de modificar vehículos por otros de similar categoría.'
            ];
            
            terminos.forEach(termino => {
                const lines = doc.splitTextToSize(termino, 170);
                doc.text(lines, 20, y);
                y += lines.length * 5 + 2;
            });
            
            y += 20;
            
            // ========== MENSAJE FINAL ==========
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.setTextColor(...azulOscuro);
            doc.text('¡Gracias por preferir nuestros servicios!', 105, y, { align: 'center' });
            y += 10;
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('Estamos comprometidos con brindarle una experiencia', 105, y, { align: 'center' });
            y += 5;
            doc.text('de movilización segura y confortable.', 105, y, { align: 'center' });
            
            y += 20;
            
            doc.setFontSize(10);
            doc.setFont(undefined, 'bold');
            doc.text('Gerente General', 105, y, { align: 'center' });
            y += 5;
            doc.setFont(undefined, 'normal');
            doc.text('César De la Cruz Vilcapoma', 105, y, { align: 'center' });
            y += 5;

            // AGREGAR LÍNEA PARA FIRMA
            doc.setDrawColor(0, 0, 0); // Color negro para la línea
            doc.setLineWidth(0.5); // Grosor de la línea
            doc.line(80, y, 130, y); // Línea horizontal centrada (x1, y1, x2, y2)
            y += 8; // Espacio después de la línea

            doc.text('DNI: 74039078', 105, y, { align: 'center' });
            y += 5;
            doc.text('RUC: 20603243251', 105, y, { align: 'center' });
            y += 5;
            doc.text('Agencia de Viajes y Transportes de Turismo C tours E.I.R.L', 105, y, { align: 'center' });
            
            // Pie de página para la tercera página
            doc.setFillColor(...azulOscuro);
            doc.rect(0, 277, 210, 20, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(8);
            doc.setFont(undefined, 'italic');
            doc.text('C tours | +51 992 248 858 | www.agenciactours.com', 105, 285, { align: 'center' });
            doc.text('Página 3 de 3', 195, 285, { align: 'right' });
            
            // AQUÍ VA EL NUEVO CÓDIGO (reemplaza el doc.save anterior)
            // Generar el PDF como Blob
            const pdfBlob = doc.output('blob');
            const fileName = `Cotizacion_CTours_${quoteNum}.pdf`;

            // Guardar para compartir después
            currentPdfBlob = pdfBlob;
            currentPdfName = fileName;

            // Mostrar botón de compartir
            sharePdfBtn.classList.remove('hidden');

            // Descargar automáticamente
            doc.save(fileName);

            // Verificar si el dispositivo soporta Web Share API
            if (navigator.share) {
                // Mostrar mensaje de éxito con opción de compartir
                setTimeout(() => {
                    if (confirm('✅ PDF generado exitosamente.\n\n¿Desea compartirlo ahora por WhatsApp, correo u otras aplicaciones?')) {
                        sharePdf();
                    }
                }, 500);
            } else {
                alert('✅ PDF generado y descargado exitosamente.\n\nPuede encontrarlo en sus descargas.');
            }
        };

        // Si hay error al cargar la imagen, generar PDF sin logo
        img.onerror = async function() {
            console.warn('No se pudo cargar el logo, generando PDF sin imagen');
            
            const pdfBlob = doc.output('blob');
            const fileName = `Cotizacion_CTours_${quoteNum}.pdf`;
            
            currentPdfBlob = pdfBlob;
            currentPdfName = fileName;
            sharePdfBtn.classList.remove('hidden');
            
            doc.save(fileName);
            
            if (navigator.share) {
                setTimeout(() => {
                    if (confirm('✅ PDF generado exitosamente.\n\n¿Desea compartirlo ahora?')) {
                        sharePdf();
                    }
                }, 500);
            } else {
                alert('✅ PDF generado y descargado exitosamente.');
            }
        };
    }
        
        async function sharePdf() {
            if (!currentPdfBlob || !currentPdfName) {
                alert('Primero debe generar el PDF.');
                return;
            }
            
            try {
                const file = new File([currentPdfBlob], currentPdfName, { type: 'application/pdf' });
                
                if (navigator.share && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        title: 'Cotización C tours E.I.R.L',
                        text: 'Cotización de servicios de movilización',
                        files: [file]
                    });
                    console.log('PDF compartido exitosamente');
                } else if (navigator.share) {
                    const url = URL.createObjectURL(currentPdfBlob);
                    await navigator.share({
                        title: 'Cotización C tours E.I.R.L',
                        text: 'Cotización de servicios de movilización - C tours',
                        url: url
                    });
                    setTimeout(() => URL.revokeObjectURL(url), 60000);
                } else {
                    const url = URL.createObjectURL(currentPdfBlob);
                    const newWindow = window.open(url, '_blank');
                    
                    if (!newWindow) {
                        alert('No se pudo abrir el PDF. Por favor, verifique que su navegador permite ventanas emergentes.');
                    } else {
                        alert('PDF abierto en nueva ventana. Use el menú de su navegador para compartir.');
                    }
                    
                    setTimeout(() => URL.revokeObjectURL(url), 60000);
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    console.log('Compartir cancelado por el usuario');
                } else {
                    console.error('Error al compartir:', error);
                    alert('No se pudo compartir el PDF. El archivo ha sido descargado en su dispositivo.');
                }
            }
        }
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('es-ES', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }
        
        function getServiceTypeText(value) {
            const texts = {
                transfer: 'Transfer Aeropuerto/Hotel',
                city: 'Tour Ciudad',
                intercity: 'Transporte Interurbano',
                school: 'Viaje de Estudios',
                corporate: 'Servicio Corporativo',
                event: 'Transporte para Eventos',
                custom: 'Servicio Personalizado'
            };
            return texts[value] || value;
        }
        
        function getVehicleTypeText(value) {
            const texts = {
                sedan: 'Sedán',
                suv: 'SUV',
                pick: 'Pick Up / Camioneta',
                van: 'Van',
                minivan: 'Mini Van',
                minibus: 'Minibús',
                bus: 'Autobús'
            };
            return texts[value] || value;
        }
        
        costPerPassenger.addEventListener('input', calculateCosts);
        passengers.addEventListener('input', calculateCosts);
        discount.addEventListener('input', calculateCosts);
        includeIgv.addEventListener('change', calculateCosts);
        
        previewBtn.addEventListener('click', showPreview);
        generatePdfBtn.addEventListener('click', generatePDF);
        sharePdfBtn.addEventListener('click', sharePdf);
        
        resetBtn.addEventListener('click', function() {
            if (confirm('¿Está seguro de que desea limpiar el formulario? Se perderán todos los datos.')) {
                clientName.value = '';
                clientEmail.value = '';
                clientPhone.value = '';
                clientDni.value = '';
                clientAddress.value = '';
                serviceType.value = 'transfer';
                vehicleType.value = 'sedan';
                startDate.value = '';
                endDate.value = '';
                destination.value = '';
                costPerPassenger.value = '0.00';
                passengers.value = '1';
                discount.value = '0';
                includeIgv.checked = true;
                includedServices.value = '';
                excludedServices.value = '';
                recommendations.value = '';
                
                additionalServicesContainer.innerHTML = '';
                
                pdfPreview.classList.add('hidden');
                sharePdfBtn.classList.add('hidden');
                currentPdfBlob = null;
                currentPdfName = null;
                calculateCosts();
            }
        });
        
        const today = new Date().toISOString().split('T')[0];
        startDate.min = today;
        endDate.min = today;
        
        calculateCosts();
    </script>
</body>
</html>
