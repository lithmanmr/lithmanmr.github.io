<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C tours E.I.R.L - Cotizador</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#1a365d">
    <meta name="apple-mobile-web-app-status-bar-style" content="#1a365d">
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
    
    <!-- Meta tags PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="C tours">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Meta tags SEO -->
    <meta name="description" content="Cotizador de servicios de movilización y transporte turístico - C tours E.I.R.L. Genera cotizaciones profesionales en PDF.">
    <meta name="keywords" content="C tours, transporte turístico, cotizador, movilización, Ayacucho, Perú">
    <meta name="author" content="C tours E.I.R.L">
    
    <!-- Open Graph (Redes Sociales) -->
    <meta property="og:title" content="C tours E.I.R.L - Cotizador de Servicios">
    <meta property="og:description" content="Agencia de viajes y transporte de turismo en Ayacucho">
    <meta property="og:image" content="assets/android-chrome-512x512.png">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://Ctours.github.io.">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="C tours E.I.R.L - Cotizador de Servicios">
    <meta name="twitter:description" content="Agencia de viajes y transporte de turismo">
    <meta name="twitter:image" content="assets/android-chrome-512x512.png">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a365d;
            --secondary: #2d3748;
            --accent: #d4af37;
            --accent-dark: #b8941f;
            --light: #f7fafc;
            --gray: #e2e8f0;
            --dark: #2d3748;
            --success: #38a169;
            --gold-light: #fef9e7;
            --blue-light: #ebf8ff;
            --green-light: #f0fff4;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 15px;
        }

        /* ========== ESTILOS DE PRECARGA ========== */
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 99999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        
        #preloader.fade-out {
            opacity: 0;
            visibility: hidden;
        }
        
        .preloader-content {
            text-align: center;
            color: white;
            animation: fadeInUp 0.8s ease;
        }
        
        .logo-container {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
        }
        
        .logo-circle {
            width: 120px;
            height: 120px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
        }
        
        .preloader-logo {
            width: 110px;
            height: 110px;
            object-fit: contain;
            animation: rotate 2s linear infinite;
            filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.1));
        }
        
        .logo-pulse {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--accent);
            opacity: 0.3;
            z-index: 1;
            animation: pulse 2s ease-in-out infinite;
        }
        
        .preloader-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: 1px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .preloader-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 30px;
            font-weight: 300;
        }
        
        .loading-bar {
            width: 250px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            margin: 0 auto 15px;
            overflow: hidden;
        }
        
        .loading-progress {
            height: 100%;
            background: var(--accent);
            border-radius: 10px;
            animation: loadingProgress 2s ease-in-out;
            box-shadow: 0 0 10px var(--accent);
        }
        
        .loading-text {
            font-size: 0.9rem;
            opacity: 0.8;
            font-weight: 300;
            animation: blink 1.5s ease-in-out infinite;
        }
        
        /* Animaciones */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.3;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.3);
                opacity: 0;
            }
        }
        
        @keyframes loadingProgress {
            0% {
                width: 0%;
            }
            100% {
                width: 100%;
            }
        }
        
        @keyframes blink {
            0%, 100% {
                opacity: 0.8;
            }
            50% {
                opacity: 0.3;
            }
        }
        
        @media (max-width: 768px) {
            .logo-container {
                width: 100px;
                height: 100px;
            }
            
            .logo-circle {
                width: 100px;
                height: 100px;
            }
            
            .preloader-logo {
                width: 65px;
                height: 65px;
            }
            
            .logo-pulse {
                width: 100px;
                height: 100px;
            }
            
            .preloader-title {
                font-size: 1.5rem;
            }
            
            .preloader-subtitle {
                font-size: 0.9rem;
            }
            
            .loading-bar {
                width: 200px;
            }
        }
        /* ========== FIN ESTILOS DE PRECARGA ========== */
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 25px 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }
        
        .header-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
            position: relative;
            z-index: 1;
        }
        
        @media (min-width: 768px) {
            .header-content {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
        }
        
        @media (min-width: 768px) {
            .logo {
                justify-content: flex-start;
            }
        }
        
        .logo-icon {
            font-size: 2.2rem;
            color: var(--accent);
        }
        
        .logo-text {
            font-size: 1.6rem;
            font-weight: 700;
            text-align: center;
        }
        
        .tagline {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 5px;
            text-align: center;
        }
        
        .header-contact {
            text-align: center;
        }
        
        @media (min-width: 768px) {
            .header-contact {
                text-align: right;
            }
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 0.9rem;
        }
        
        .contact-link {
            color: white;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .contact-link:hover {
            color: var(--accent);
        }
        
        .form-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (min-width: 768px) {
            .form-container {
                grid-template-columns: 1fr 1fr;
                gap: 25px;
            }
        }
        
        .form-section {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .form-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--gray);
            font-size: 1.2rem;
        }
        
        .section-title i {
            color: var(--accent);
            font-size: 1.2rem;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--secondary);
            font-size: 0.95rem;
        }
        
        .input-with-icon {
            position: relative;
        }
        
        .input-with-icon i {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent);
        }
        
        .input-with-icon input, .input-with-icon select, .input-with-icon textarea {
            padding-left: 40px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--gray);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
            background-color: var(--light);
            max-width: 100%;           /* NUEVO */
            box-sizing: border-box;    /* NUEVO */
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--accent);
            outline: none;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
        }
        
        .row {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        @media (min-width: 480px) {
            .row {
                flex-direction: row;
                gap: 12px;
            }
        }

        .row .form-group {
            flex: 1;
            min-width: 0;              /* NUEVO: Permite que se encoja */
            overflow: hidden;          /* NUEVO: Previene desbordamiento */
        }

        /* NUEVO: Ajuste específico para inputs de fecha en móviles */
        @media (max-width: 480px) {
            .row .form-group input[type="date"] {
                font-size: 14px;       /* Letra un poco más pequeña */
                padding: 10px 8px;     /* Menos padding */
            }
            
            .input-with-icon input[type="date"] {
                padding-left: 35px;    /* Ajustar espacio del ícono */
            }
            
            .input-with-icon i {
                font-size: 0.9rem;     /* Ícono más pequeño */
                left: 10px;            /* Más cerca del borde */
            }
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .checkbox-group input {
            width: auto;
        }
        
        .cost-summary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 25px 20px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            margin-bottom: 25px;
        }
        
        .cost-summary h2 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.4rem;
        }
        
        .cost-summary h2 i {
            color: var(--accent);
        }
        
        .cost-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95rem;
        }
        
        .cost-total {
            display: flex;
            justify-content: space-between;
            padding: 15px 0 0;
            font-size: 1.3rem;
            font-weight: bold;
            margin-top: 12px;
            border-top: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 25px;
        }
        
        @media (min-width: 480px) {
            .actions {
                flex-direction: row;
                justify-content: center;
                gap: 15px;
            }
        }
        
        button {
            padding: 14px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
        }
        
        @media (min-width: 480px) {
            button {
                flex: 0 1 auto;
            }
        }
        
        .btn-primary {
            background-color: var(--accent);
            color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: var(--accent-dark);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        }
        
        .btn-secondary {
            background-color: white;
            color: var(--primary);
            border: 1px solid var(--gray);
        }
        
        .btn-secondary:hover {
            background-color: var(--light);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-accent {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-accent:hover {
            background-color: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(26, 54, 93, 0.4);
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #2f855a;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(56, 161, 105, 0.4);
        }
        
        .hidden {
            display: none;
        }
        
        #pdfPreview {
            margin-top: 30px;
            background-color: white;
            padding: 0;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--gray);
            overflow: hidden;
            max-width: 100%;
            width: 100%;
            box-sizing: border-box;
        }

        @media (max-width: 768px) {
            #pdfPreview {
                margin: 20px 0 0 0;
                border-radius: 8px;
                overflow-x: hidden;
                width: 100%;
            }
        }
        
        /* ESTILOS OPTIMIZADOS PARA PDF */
        .pdf-mode .preview-container {
            width: 900px !important;
            max-width: 900px !important;
            min-width: 900px !important;
            padding: 30px !important;
            margin: 0 auto !important;
        }
        
        .preview-container {
            padding: 30px 20px;
            background: white;
            position: relative;
            max-width: 100%;
            overflow-x: hidden;
            box-sizing: border-box;
        }
        
        @media (min-width: 768px) {
            .preview-container {
                padding: 40px;
            }
        }

        /* NUEVO: Prevenir desbordamiento en móviles */
        @media (max-width: 768px) {
            .preview-container {
                padding: 20px 15px;
                overflow-x: hidden;
                max-width: 100%;
                width: 100%;
            }
            
            .preview-section {
                padding: 15px 10px;
                margin-bottom: 15px;
            }
            
            .preview-header {
                margin: -15px -10px 20px -10px;
                padding: 15px 10px;
            }
            
            .preview-title h1 {
                font-size: 1.1rem;
                word-wrap: break-word;
            }
            
            .preview-company-info {
                font-size: 0.7rem;
            }
            
            .preview-logo-text {
                font-size: 1.2rem;
            }
        }
        
        /* Header compacto */
        .pdf-mode .preview-header {
            padding: 15px 20px !important;
            margin: -30px -30px 20px -30px !important;
        }
        
        .pdf-mode .preview-logo-text {
            font-size: 1.3rem !important;
        }
        
        .pdf-mode .preview-company-info {
            font-size: 0.75rem !important;
        }
        
        .preview-header {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 3px solid var(--accent);
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px;
            margin: -30px -20px 30px -20px;
            border-radius: 0;
            max-width: 100%;
            box-sizing: border-box;
        }
        
        @media (min-width: 768px) {
            .preview-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: flex-start;
                margin: -40px -40px 40px -40px;
                padding: 25px;
            }
        }
        
        .preview-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
        }
        
        @media (min-width: 768px) {
            .preview-logo {
                justify-content: flex-start;
            }
        }
        
        .preview-logo-icon {
            font-size: 2.2rem;
            color: var(--accent);
        }
        
        .preview-logo-text {
            font-size: 1.6rem;
            font-weight: 700;
            color: white;
            text-align: center;
        }
        
        @media (min-width: 768px) {
            .preview-logo-text {
                text-align: left;
            }
        }
        
        .preview-company-info {
            text-align: center;
            color: rgba(255,255,255,0.9);
            font-size: 0.85rem;
        }
        
        @media (min-width: 768px) {
            .preview-company-info {
                text-align: right;
            }
        }
        
        /* Título compacto */
        .pdf-mode .preview-title {
            padding: 12px !important;
            margin: 15px 0 !important;
        }
        
        .pdf-mode .preview-title h1 {
            font-size: 1.3rem !important;
            margin-bottom: 5px !important;
        }
        
        .pdf-mode .preview-title p {
            font-size: 0.8rem !important;
        }
        
        .pdf-mode .preview-badge {
            font-size: 0.75rem !important;
            padding: 3px 10px !important;
        }
        
        .preview-title {
            text-align: center;
            margin: 25px auto;
            color: var(--primary);
            background: var(--gold-light);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--accent);
            max-width: 100%;
            box-sizing: border-box;
        }
        
        .preview-title h1 {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: var(--primary);
        }
        
        .preview-title p {
            font-size: 0.9rem;
            color: var(--secondary);
        }
        
        /* Secciones compactas */
        .pdf-mode .preview-section {
            margin-bottom: 15px !important;
            padding: 15px !important;
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-section-title {
            font-size: 1rem !important;
            margin-bottom: 12px !important;
            padding-bottom: 6px !important;
        }
        
        .pdf-mode .preview-section-title i {
            font-size: 0.9rem !important;
        }
        
        .preview-section {
            margin-bottom: 25px;
            padding: 20px;
            background: var(--light);
            border-radius: 10px;
            border-left: 4px solid var(--accent);
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .preview-section-title {
            color: var(--primary);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
        }
        
        .preview-section-title i {
            color: var(--accent);
        }
        
        /* Filas compactas */
        .pdf-mode .preview-row {
            margin-bottom: 6px !important;
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-label {
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-value {
            font-size: 0.85rem !important;
        }
        
        .preview-row {
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
        }
        
        @media (min-width: 480px) {
            .preview-row {
                flex-direction: row;
            }
        }

        /* NUEVO: Ajuste para valores largos */
        .preview-value {
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            max-width: 100%;
            white-space: normal;
        }
        
        .preview-label {
            font-weight: bold;
            width: 100%;
            color: var(--secondary);
            margin-bottom: 4px;
        }
        
        @media (min-width: 480px) {
            .preview-label {
                width: 40%;
                margin-bottom: 0;
            }
        }
        
        .preview-value {
            width: 100%;
        }
        
        @media (min-width: 480px) {
            .preview-value {
                width: 60%;
            }
        }
        
        /* Costos compactos */
        .pdf-mode .preview-costs {
            padding: 15px !important;
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-cost-item {
            padding: 6px 0 !important;
            font-size: 0.85rem !important;
        }
        
        .pdf-mode .preview-cost-total {
            font-size: 1rem !important;
            padding: 10px 0 0 !important;
        }
        
        .preview-costs {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 16px;
            border: 1px solid var(--gray);
            background: linear-gradient(135deg, #fef9e7 0%, #fcf3cf 100%);
        }
        
        .preview-cost-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .preview-cost-total {
            display: flex;
            justify-content: space-between;
            padding: 12px 0 0;
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 12px;
            border-top: 2px solid var(--primary);
            color: var(--primary);
        }
        
        /* Servicios en grid compacto */
        .pdf-mode .preview-services {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 12px !important;
        }
        
        .pdf-mode .service-included,
        .pdf-mode .service-excluded {
            padding: 12px !important;
        }
        
        .pdf-mode .service-title {
            font-size: 0.9rem !important;
            margin-bottom: 8px !important;
        }
        
        .pdf-mode .service-list li {
            font-size: 0.8rem !important;
            margin-bottom: 4px !important;
            padding-left: 15px !important;
        }
        
        .preview-services {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-top: 12px;
        }
        
        @media (min-width: 768px) {
            .preview-services {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .service-included, .service-excluded {
            padding: 18px;
            border-radius: 8px;
        }
        
        .service-included {
            background: var(--green-light);
            border-left: 4px solid var(--success);
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .service-excluded {
            background: #fff5f5;
            border-left: 4px solid #e53e3e;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .service-title {
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 1rem;
        }
        
        .service-included .service-title {
            color: var(--success);
        }
        
        .service-excluded .service-title {
            color: #e53e3e;
        }
        
        .service-list {
            list-style-type: none;
        }
        
        .service-list li {
            margin-bottom: 6px;
            padding-left: 18px;
            position: relative;
            font-size: 0.9rem;
        }
        
        .service-included .service-list li:before {
            content: "✓";
            color: var(--success);
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        .service-excluded .service-list li:before {
            content: "✗";
            color: #e53e3e;
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        /* Recomendaciones compactas */
        .pdf-mode .preview-recommendations {
            padding: 12px !important;
            font-size: 0.8rem !important;
        }
        
        .pdf-mode .preview-recommendations p {
            margin-bottom: 4px !important;
        }
        
        .preview-recommendations {
            background: var(--blue-light);
            padding: 18px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            margin-top: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        /* Servicios adicionales compactos */
        .pdf-mode .preview-additional-services {
            padding: 12px !important;
        }
        
        .pdf-mode .additional-service-item {
            padding: 5px 0 !important;
            font-size: 0.85rem !important;
        }
        
        .preview-footer {
            margin-top: 40px;
            padding-top: 18px;
            border-top: 2px solid var(--accent);
            text-align: center;
            color: var(--secondary);
            background: var(--light);
            padding: 20px;
            border-radius: 10px;
        }
        
        .footer-contact {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 16px 0;
            align-items: center;
        }
        
        @media (min-width: 480px) {
            .footer-contact {
                flex-direction: row;
                justify-content: center;
                gap: 20px;
            }
        }
        
        .footer-contact-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .input-group {
            display: flex;
            align-items: center;
        }
        
        .currency {
            background: var(--primary);
            color: white;
            padding: 12px 12px;
            border-radius: 8px 0 0 8px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .currency-input {
            border-radius: 0 8px 8px 0 !important;
            padding-left: 12px !important;
        }
        
        .notes {
            font-size: 0.85rem;
            color: var(--secondary);
            margin-top: 4px;
            font-style: italic;
        }
        
        .watermark {
            position: absolute;
            bottom: 20px;
            right: 20px;
            opacity: 0.05;
            font-size: 4rem;
            color: var(--primary);
            transform: rotate(-15deg);
            pointer-events: none;
            font-weight: bold;
        }
        
        @media (min-width: 768px) {
            .watermark {
                font-size: 5rem;
                bottom: 30px;
                right: 30px;
            }
        }
        
        .preview-badge {
            background: var(--accent);
            color: var(--primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.85rem;
            display: inline-block;
            margin-bottom: 8px;
        }
        
        .additional-service {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        @media (min-width: 480px) {
            .additional-service {
                flex-direction: row;
                align-items: center;
                gap: 10px;
            }
        }
        
        .additional-service input {
            flex: 1;
        }
        
        .additional-service .cost-input {
            width: 100%;
        }
        
        @media (min-width: 480px) {
            .additional-service .cost-input {
                width: 130px;
            }
        }
        
        .add-service-btn {
            background: var(--success);
            color: white;
            border: none;
            padding: 10px 14px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .remove-service-btn {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .page-number {
            position: absolute;
            bottom: 15px;
            right: 20px;
            color: var(--secondary);
            font-size: 0.8rem;
        }
        
        .pdf-mode .page-number {
            font-size: 0.7rem !important;
        }
        
        .final-page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            min-height: 80vh;
            padding: 40px 20px;
        }
        
        .pdf-mode .final-page {
            min-height: 60vh !important;
            padding: 30px 20px !important;
        }
        
        .pdf-mode .final-message h2 {
            font-size: 1.2rem !important;
        }
        
        .pdf-mode .management-info {
            font-size: 0.85rem !important;
        }
        
        .final-message {
            max-width: 600px;
            margin-bottom: 40px;
        }
        
        .management-info {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--gray);
            width: 100%;
            max-width: 400px;
        }
        
        .management-info p {
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .no-underline {
            text-decoration: none !important;
        }
        
        .preview-additional-services {
            background: #f8f9fa;
            padding: 18px;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
            margin-top: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        .preview-additional-services-title {
            color: var(--primary);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
        }
        
        .additional-service-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .additional-service-desc {
            font-weight: 500;
        }
        
        .additional-service-cost {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* Estilos para tablas profesionales */
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9rem;
            table-layout: fixed;
            max-width: 100%;
            overflow-wrap: break-word;
        }

        /* NUEVO: Hacer tablas responsivas en móviles */
        @media (max-width: 768px) {
            .preview-table {
                font-size: 0.8rem;
                display: block;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                width: 100%;
                margin: 15px 0;
            }
            
            .preview-table tbody {
                display: block;
                width: 100%;
            }
            
            .preview-table tr {
                display: block;
                margin-bottom: 10px;
                border: 1px solid var(--gray);
                border-radius: 8px;
                padding: 10px;
                background: white;
            }
            
            .preview-table td {
                display: block;
                width: 100% !important;
                text-align: left !important;
                padding: 5px 0;
                border: none;
                word-wrap: break-word;
            }
            
            .preview-table td:first-child {
                font-weight: bold;
                color: var(--primary);
                margin-bottom: 3px;
            }
        }
        
        .preview-table th {
            background-color: var(--primary);
            color: white;
            padding: 10px;
            text-align: left;
            font-weight: 600;
        }
        
        .preview-table td {
            padding: 10px;
            border-bottom: 1px solid var(--gray);
        }
        
        .preview-table tr:nth-child(even) {
            background-color: var(--light);
        }
        
        .preview-table tr:hover {
            background-color: rgba(212, 175, 55, 0.1);
        }
        
        /* Estilos para el logo en PDF */
        .pdf-logo {
            width: 60px;
            height: 60px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--primary);
            border: 2px solid var(--accent);
        }
        
        /* Pie de página en PDF */
        .pdf-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--primary);
            color: white;
            padding: 8px 15px;
            font-size: 0.7rem;
            text-align: center;
        }

        /* ========== ESTILOS PARA LOGO DEL ENCABEZADO ========== */
        .logo-image {
            width: 150px; /* Ajusta el tamaño que prefieras */
            height: 150px;
            object-fit: contain;
            /* Quitamos la animación rotate que estaba aquí */
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
            transition: transform 0.3s ease; /* Solo para hover opcional */
        }

        /* Tamaño mayor en escritorio si lo deseas */
        @media (min-width: 768px) {
            .logo-image {
                width: 65px;
                height: 65px;
            }
        }

        /* Hover opcional para el logo del encabezado */
        .logo-image:hover {
            transform: scale(1.05);
        }

        /* Logo para el preview del PDF (también necesita tamaño fijo) */
        .preview-logo .logo-image {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }

        /* ========== REORGANIZACIÓN DEL LOGO PARA MÓVILES ========== */

        /* Contenedor principal del logo y texto */
        .logo-and-text {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 15px;
            text-align: left;
        }

        /* Logo para escritorio (visible solo en pantallas grandes) */
        .desktop-logo {
            width: 70px;
            height: 70px;
            object-fit: contain;
            display: none; /* Oculto por defecto */
        }

        /* Logo para móviles (arriba del texto) */
        .mobile-logo-container {
            display: none; /* Oculto por defecto */
            text-align: center;
            margin-bottom: 5px; /* REDUCIDO de 15px a 5px */
        }

        .mobile-logo-container .logo-image {
            width: 120px; /* REDUCIDO de 300px a 120px */
            height: 120px; /* REDUCIDO de 300px a 120px */
            object-fit: contain;
            margin: 0 auto;
            display: block;
        }

        /* Contenedor de texto */
        .logo-text-container {
            text-align: center;
        }

        /* En móviles */
        /* En móviles */
        @media (max-width: 767px) {
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 5px; /* NUEVO: Reduce espacio general */
            }
            
            /* Mostrar logo móvil */
            .mobile-logo-container {
                display: block;
                order: 1;
                margin-bottom: 8px; /* NUEVO: Espacio compacto */
            }
            
            /* Reorganizar logo y texto */
            .logo-and-text {
                flex-direction: column;
                gap: 5px; /* REDUCIDO de 10px a 5px */
                order: 2;
                width: 100%;
                margin-top: 0; /* NUEVO: Sin margen superior */
            }
            
            /* Ocultar logo desktop en móviles */
            .desktop-logo {
                display: none;
            }
            
            /* Texto centrado y con buen espaciado */
            /* Texto centrado y con buen espaciado */
            .logo-text {
                font-size: 1.8rem;
                text-align: center;
                width: 100%;
                margin-top: 0; /* NUEVO: Sin margen superior */
                line-height: 1.2; /* NUEVO: Altura de línea compacta */
            }
            
            .tagline {
                font-size: 1rem;
                text-align: center;
                margin-top: 3px; /* REDUCIDO de 5px a 3px */
                width: 100%;
                line-height: 1.3; /* NUEVO: Altura de línea compacta */
            }
            
            /* Información de contacto */
            .header-contact {
                order: 3; /* Tercera posición */
                text-align: center;
                width: 100%;
                margin-top: 20px;
            }
            
            .contact-item {
                justify-content: center;
                margin-bottom: 8px;
            }
        }

        /* En escritorio */
        @media (min-width: 768px) {
            .desktop-logo {
                display: block; /* Mostrar logo desktop */
            }
            
            .mobile-logo-container {
                display: none; /* Ocultar logo móvil */
            }
            
            .logo-and-text {
                flex-direction: row;
                align-items: center;
            }
            
            .logo-text-container {
                text-align: left;
            }
            
            .logo-text {
                text-align: left;
            }
            
            .tagline {
                text-align: left;
            }
            
            .header-contact {
                text-align: right;
            }
        }

        /* ========== ESTILOS PARA VISTA PREVIA SIMPLIFICADA ========== */

        #pdfPreview {
            margin-top: 30px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--gray);
            overflow: hidden;
        }

        .preview-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .preview-header h2 {
            font-size: 1.5rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .preview-header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .preview-container {
            padding: 25px;
        }

        .preview-section {
            background: var(--light);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent);
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        .preview-section-title {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
        }

        .preview-data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .data-label {
            font-weight: 600;
            color: var(--secondary);
            min-width: 140px;
        }

        .data-value {
            color: var(--dark);
            text-align: right;
            word-break: break-word;
            max-width: 100%;
            overflow-wrap: break-word;
        }

        .cost-summary-preview {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--gray);
        }

        .cost-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .cost-row.total {
            border-top: 2px solid var(--primary);
            border-bottom: none;
            margin-top: 10px;
            padding-top: 15px;
            font-size: 1.1rem;
            color: var(--primary);
        }

        .services-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .service-item-preview {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            background: white;
            border-radius: 6px;
            border: 1px solid var(--gray);
        }

        .preview-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--gray);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .preview-data-grid {
                grid-template-columns: 1fr;
            }
            
            .data-row {
                flex-direction: column;
                gap: 5px;
            }
            
            .data-label, .data-value {
                text-align: left;
                min-width: auto;
                max-width: 100%;
            }
            
            .preview-actions {
                flex-direction: column;
            }
            
            .preview-actions button {
                width: 100%;
            }
        }

        /* ========== BOTÓN ACERCA DE ========== */
        .about-btn {
            background: transparent;
            color: white;
            border: 2px solid var(--accent);
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            box-shadow: none;
        }

        .about-btn:hover {
            background: var(--accent);
            color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
        }

        /* ========== MODAL ACERCA DE ========== */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .modal.hidden {
            display: none;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            position: relative;
            animation: slideDown 0.4s ease;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 28px;
            font-weight: bold;
            color: var(--secondary);
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
        }

        .close-modal:hover {
            color: #e74c3c;
            transform: rotate(90deg);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 25px 20px;
            border-radius: 15px 15px 0 0;
            text-align: center;
        }

        .modal-icon {
            font-size: 3rem;
            margin-bottom: 10px;
            color: var(--accent);
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .modal-body {
            padding: 30px 25px;
            color: var(--secondary);
        }

        .modal-body h3 {
            color: var(--primary);
            font-size: 1.1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .modal-body p {
            margin: 8px 0;
            line-height: 1.6;
        }

        .modal-divider {
            height: 1px;
            background: linear-gradient(to right, transparent, var(--gray), transparent);
            margin: 20px 0;
        }

        .tech-list {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .tech-list li {
            background: var(--light);
            padding: 10px 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tech-list li:hover {
            background: var(--accent);
            color: white;
            transform: translateX(5px);
        }

        .tech-list i {
            font-size: 1.2rem;
        }

        .modal-footer-text {
            text-align: center;
            font-style: italic;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--gray);
            color: var(--secondary);
        }

        /* Animaciones */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                max-height: 90vh;
            }
            
            .modal-body {
                padding: 20px 15px;
            }
            
            .tech-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    
    <body>
    <!-- PRECARGA ELEGANTE -->
    <div id="preloader">
        <div class="preloader-content">
            <div class="logo-container">
                <div class="logo-circle">
                    <img src="assets/logo.png" alt="C tours Logo" class="preloader-logo">
                </div>
                <div class="logo-pulse"></div>
            </div>
            <h2 class="preloader-title">C tours E.I.R.L</h2>
            <p class="preloader-subtitle">App de cotización</p>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
            <p class="loading-text">Cargando...</p>
        </div>
    </div>
    <!-- FIN PRECARGA -->
    
    <div class="container">
        <!-- El resto del contenido continúa aquí... -->

    <div class="container">
        <header>
            <div class="header-content">
                <!-- Contenedor del logo SOLO para móviles -->
                <div class="mobile-logo-container">
                    <img src="assets/logo.png" alt="C tours Logo" class="logo-image">
                </div>
                
                <div class="logo-and-text">
                    <!-- Logo solo visible en escritorio -->
                    <img src="assets/logo.png" alt="C tours Logo" class="desktop-logo">
                    <div class="logo-text-container">
                        <div class="logo-text">C tours E.I.R.L</div>
                        <div class="tagline">Agencia de viajes y transporte de turismo</div>
                    </div>
                </div>
                
                <div class="header-contact">
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Portal Constitución 9 - Oficina 3</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <span>+51 992 248 858</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <a href="mailto:info@agenciactours.com" class="contact-link no-underline">agenciactours@gmail.com</a>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-globe"></i>
                        <a href="https://www.agenciactours.com" target="_blank" class="contact-link no-underline">www.agenciactours.com</a>
                    </div>
                    <div class="contact-item" style="margin-top: 10px;">
                        <button id="aboutBtn" class="about-btn">
                            <i class="fas fa-info-circle"></i> Acerca de
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="form-container">
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-user-circle"></i>
                    Información del Cliente
                </h2>
                
                <div class="form-group">
                    <label for="clientName">Nombre Completo / Empresa</label>
                    <div class="input-with-icon">
                        <i class="fas fa-user"></i>
                        <input type="text" id="clientName" placeholder="Ingresa el nombre completo">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="clientEmail">Correo Electrónico</label>
                    <div class="input-with-icon">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="clientEmail" placeholder="ejemplo@correo.com">
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label for="clientPhone">Teléfono</label>
                        <div class="input-with-icon">
                            <i class="fas fa-phone"></i>
                            <input type="tel" id="clientPhone" placeholder="Número de contacto">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="clientDni">DNI / Pasaporte</label>
                        <div class="input-with-icon">
                            <i class="fas fa-id-card"></i>
                            <input type="text" id="clientDni" placeholder="Número de documento">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="clientAddress">Dirección</label>
                    <div class="input-with-icon">
                        <i class="fas fa-home"></i>
                        <textarea id="clientAddress" rows="2" placeholder="Dirección completa"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-route"></i>
                    Detalles del Servicio
                </h2>
                
                <div class="form-group">
                    <label for="serviceType">Tipo de Servicio</label>
                    <div class="input-with-icon">
                        <i class="fas fa-car-side"></i>
                        <select id="serviceType">
                            <option value="transfer">Transfer Aeropuerto/Hotel</option>
                            <option value="city">Tour Ciudad</option>
                            <option value="intercity">Transporte Interurbano</option>
                            <option value="school">Viaje de Estudios</option>
                            <option value="corporate">Servicio Corporativo</option>
                            <option value="event">Transporte para Eventos</option>
                            <option value="custom">Servicio Personalizado</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="vehicleType">Tipo de Vehículo</label>
                    <div class="input-with-icon">
                        <i class="fas fa-bus"></i>
                        <select id="vehicleType">
                            <option value="sedan">Sedán</option>
                            <option value="suv">SUV</option>
                            <option value="pick">Pick Up / Camioneta</option>
                            <option value="van">Van</option>
                            <option value="minivan">Mini Van</option>
                            <option value="minibus">Minibús</option>
                            <option value="bus">Autobús</option>
                        </select>
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label for="startDate">Fecha de Ida</label>
                        <div class="input-with-icon">
                            <i class="fas fa-calendar-alt"></i>
                            <input type="date" id="startDate">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="endDate">Fecha de Vuelta</label>
                        <div class="input-with-icon">
                            <i class="fas fa-calendar-alt"></i>
                            <input type="date" id="endDate">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="destination">Lugar / Destino</label>
                    <div class="input-with-icon">
                        <i class="fas fa-map-marker-alt"></i>
                        <input type="text" id="destination" placeholder="Destino del viaje">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="form-container">
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-calculator"></i>
                    Configuración de Costos
                </h2>
                
                <div class="form-group">
                    <label for="costPerPassenger">Costo por Pasajero (S/)</label>
                    <div class="input-group">
                        <div class="currency">S/</div>
                        <input type="number" id="costPerPassenger" min="0" step="0.01" value="0.00" class="currency-input">
                    </div>
                    <div class="notes">Precio base por persona para el servicio</div>
                </div>
                
                <div class="form-group">
                    <label for="passengers">Número de Pasajeros</label>
                    <div class="input-with-icon">
                        <i class="fas fa-users"></i>
                        <input type="number" id="passengers" min="1" value="1">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="discount">Descuento (%)</label>
                    <div class="input-with-icon">
                        <i class="fas fa-tag"></i>
                        <input type="number" id="discount" min="0" max="100" value="0">
                    </div>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="includeIgv" checked>
                    <label for="includeIgv">Incluir IGV (18%)</label>
                </div>
            </div>
            
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-plus-circle"></i>
                    Servicios Adicionales
                </h2>
                
                <div id="additionalServicesContainer">
                </div>
                
                <button type="button" class="add-service-btn" onclick="addService()">
                    <i class="fas fa-plus"></i> Agregar Servicio Adicional
                </button>
                
                <div class="form-group" style="margin-top: 20px;">
                    <label for="includedServices">Servicios Incluidos</label>
                    <textarea id="includedServices" rows="4" placeholder="Lista de servicios incluidos (uno por línea)"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="excludedServices">Servicios No Incluidos</label>
                    <textarea id="excludedServices" rows="4" placeholder="Lista de servicios no incluidos (uno por línea)"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="recommendations">Recomendaciones</label>
                    <textarea id="recommendations" rows="4" placeholder="Recomendaciones para el cliente (una por línea)"></textarea>
                </div>
            </div>
        </div>
        
        <div class="cost-summary">
            <h2>
                <i class="fas fa-file-invoice-dollar"></i>
                Resumen de Costos
            </h2>
            
            <div class="cost-item">
                <span>Costo Base:</span>
                <span id="baseCost">S/ 0.00</span>
            </div>
            
            <div class="cost-item" id="additionalServicesCostItem" style="display: none;">
                <span>Servicios Adicionales:</span>
                <span id="additionalServicesCost">S/ 0.00</span>
            </div>
            
            <div class="cost-item">
                <span>Descuento:</span>
                <span id="discountDisplay">S/ 0.00</span>
            </div>
            
            <div class="cost-item" id="taxItem">
                <span>IGV (18%):</span>
                <span id="taxCost">S/ 0.00</span>
            </div>
            
            <div class="cost-total">
                <span>Total a Pagar:</span>
                <span id="totalCost">S/ 0.00</span>
            </div>
        </div>
        
        <div class="actions">
            <button class="btn-secondary" id="resetBtn">
                <i class="fas fa-undo"></i>
                Limpiar Formulario
            </button>
            <button class="btn-primary" id="previewBtn">
                <i class="fas fa-eye"></i>
                Vista Previa
            </button>
            <button class="btn-accent" id="generatePdfBtn">
                <i class="fas fa-file-pdf"></i>
                Generar PDF
            </button>

            <button class="btn-success hidden" id="sharePdfBtn">
                <i class="fas fa-share-alt"></i>
                Compartir PDF
    </button>
        </div>
        
        <!-- Vista previa simplificada -->
        <div id="pdfPreview" class="hidden">
            <div class="preview-header">
                <h2><i class="fas fa-eye"></i> Vista Previa de Cotización</h2>
                <p>Revise que toda la información sea correcta antes de generar el PDF</p>
            </div>
            
            <div class="preview-container">
                <!-- Sección Cliente -->
                <div class="preview-section">
                    <h3 class="preview-section-title">
                        <i class="fas fa-user"></i>
                        Información del Cliente
                    </h3>
                    <div class="preview-data-grid">
                        <div class="data-row">
                            <span class="data-label">Nombre:</span>
                            <span class="data-value" id="previewClientNameSimple">-</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Email:</span>
                            <span class="data-value" id="previewClientEmailSimple">-</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Teléfono:</span>
                            <span class="data-value" id="previewClientPhoneSimple">-</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">DNI/Pasaporte:</span>
                            <span class="data-value" id="previewClientDniSimple">-</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Dirección:</span>
                            <span class="data-value" id="previewClientAddressSimple">-</span>
                        </div>
                    </div>
                </div>
                
                <!-- Sección Servicio -->
                <div class="preview-section">
                    <h3 class="preview-section-title">
                        <i class="fas fa-route"></i>
                        Detalles del Servicio
                    </h3>
                    <div class="preview-data-grid">
                        <div class="data-row">
                            <span class="data-label">Tipo de Servicio:</span>
                            <span class="data-value" id="previewServiceTypeSimple">-</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Vehículo:</span>
                            <span class="data-value" id="previewVehicleTypeSimple">-</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Fecha de Ida:</span>
                            <span class="data-value" id="previewStartDateSimple">-</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Fecha de Vuelta:</span>
                            <span class="data-value" id="previewEndDateSimple">-</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Destino:</span>
                            <span class="data-value" id="previewDestinationSimple">-</span>
                        </div>
                    </div>
                </div>
                
                <!-- Sección Costos -->
                <div class="preview-section">
                    <h3 class="preview-section-title">
                        <i class="fas fa-calculator"></i>
                        Resumen de Costos
                    </h3>
                    <div class="cost-summary-preview">
                        <div class="cost-row">
                            <span>Costo Base:</span>
                            <span id="previewBaseCostSimple">S/ 0.00</span>
                        </div>
                        <div class="cost-row">
                            <span>Pasajeros:</span>
                            <span id="previewPassengersSimple">1</span>
                        </div>
                        <div class="cost-row">
                            <span>Descuento:</span>
                            <span id="previewDiscountSimple">0%</span>
                        </div>
                        <div class="cost-row">
                            <span>IGV:</span>
                            <span id="previewIgvSimple">Incluido (18%)</span>
                        </div>
                        <div class="cost-row total">
                            <strong>TOTAL A PAGAR:</strong>
                            <strong id="previewTotalCostSimple">S/ 0.00</strong>
                        </div>
                    </div>
                </div>
                
                <!-- Servicios Adicionales -->
                <div class="preview-section" id="additionalServicesPreviewSection" style="display: none;">
                    <h3 class="preview-section-title">
                        <i class="fas fa-plus-circle"></i>
                        Servicios Adicionales
                    </h3>
                    <div class="services-list" id="additionalServicesPreviewList">
                        <!-- Se llena dinámicamente -->
                    </div>
                </div>
                
                <!-- Botones de acción en vista previa -->
                <div class="preview-actions">
                    <button class="btn-secondary" onclick="closePreview()">
                        <i class="fas fa-times"></i> Cerrar Vista Previa
                    </button>
                    <button class="btn-primary" id="generateFromPreviewBtn">
                        <i class="fas fa-file-pdf"></i> Generar PDF
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Acerca de -->
        <div id="aboutModal" class="modal hidden">
            <div class="modal-content">
                <span class="close-modal" id="closeModal">&times;</span>
                <div class="modal-header">
                    <i class="fas fa-info-circle modal-icon"></i>
                    <h2>Acerca de la Aplicación</h2>
                </div>
                <div class="modal-body">
                    <h3><i class="fas fa-file-invoice"></i> Sistema de Cotización C tours</h3>
                    <p><strong>Versión:</strong> 1.0.0</p>
                    <p><strong>Copyright:</strong> @2026 Derechos reservados</p>
                    
                    <div class="modal-divider"></div>
                    
                    <h3><i class="fas fa-laptop-code"></i> Desarrollador</h3>
                    <p><strong>Nombre:</strong> Lithman A. Morales Rivera</p>
                    <p><strong>Email:</strong> lithmanmr1011@gmail.com</p>
                    <p><strong>Teléfono:</strong> 917 524 248</p>
                    
                    <div class="modal-divider"></div>
                    
                    <h3><i class="fas fa-tools"></i> Funcionalidades</h3>
                    <ul class="tech-list">
                        <li><i class="fas fa-calculator"></i> Cálculo de precios automático</li>
                        <li><i class="fas fa-tag"></i> Opción de IGV y Descuento</li>
                        <li><i class="fas fa-file-pdf"></i> Reportes PDF profesionales</li>
                        <li><i class="fas fa-share-alt"></i> Compartible (Redes sociales)</li>
                    </ul>
                    
                    <div class="modal-divider"></div>
                    
                    <p class="modal-footer-text">
                        <i class="fas fa-heart" style="color: #e74c3c;"></i> 
                        Desarrollado para <strong>C tours E.I.R.L</strong>
                    </p>
                </div>
            </div>
        </div>

    <script>
        const { jsPDF } = window.jspdf;
        
        const clientName = document.getElementById('clientName');
        const clientEmail = document.getElementById('clientEmail');
        const clientPhone = document.getElementById('clientPhone');
        const clientDni = document.getElementById('clientDni');
        const clientAddress = document.getElementById('clientAddress');
        const serviceType = document.getElementById('serviceType');
        const vehicleType = document.getElementById('vehicleType');
        const startDate = document.getElementById('startDate');
        const endDate = document.getElementById('endDate');
        const destination = document.getElementById('destination');
        const costPerPassenger = document.getElementById('costPerPassenger');
        const passengers = document.getElementById('passengers');
        const discount = document.getElementById('discount');
        const includeIgv = document.getElementById('includeIgv');
        const includedServices = document.getElementById('includedServices');
        const excludedServices = document.getElementById('excludedServices');
        const recommendations = document.getElementById('recommendations');
        const additionalServicesContainer = document.getElementById('additionalServicesContainer');
        
        const baseCostEl = document.getElementById('baseCost');
        const additionalServicesCostEl = document.getElementById('additionalServicesCost');
        const additionalServicesCostItem = document.getElementById('additionalServicesCostItem');
        const discountDisplayEl = document.getElementById('discountDisplay');
        const taxCostEl = document.getElementById('taxCost');
        const totalCostEl = document.getElementById('totalCost');
        const taxItem = document.getElementById('taxItem');
        
        const resetBtn = document.getElementById('resetBtn');
        const previewBtn = document.getElementById('previewBtn');
        const generatePdfBtn = document.getElementById('generatePdfBtn');
        const sharePdfBtn = document.getElementById('sharePdfBtn');

        let currentPdfBlob = null;
        let currentPdfName = null;
        
        const pdfPreview = document.getElementById('pdfPreview');
        const previewDate = document.getElementById('previewDate');
        const quoteNumber = document.getElementById('quoteNumber');
        const previewClientName = document.getElementById('previewClientName');
        const previewClientEmail = document.getElementById('previewClientEmail');
        const previewClientPhone = document.getElementById('previewClientPhone');
        const previewClientDni = document.getElementById('previewClientDni');
        const previewClientAddress = document.getElementById('previewClientAddress');
        const previewServiceType = document.getElementById('previewServiceType');
        const previewVehicleType = document.getElementById('previewVehicleType');
        const previewStartDate = document.getElementById('previewStartDate');
        const previewEndDate = document.getElementById('previewEndDate');
        const previewDestination = document.getElementById('previewDestination');
        const previewBaseCost = document.getElementById('previewBaseCost');
        const previewAdditionalServicesCost = document.getElementById('previewAdditionalServicesCost');
        const previewAdditionalServicesItem = document.getElementById('previewAdditionalServicesItem');
        const previewDiscount = document.getElementById('previewDiscount');
        const previewSubtotal = document.getElementById('previewSubtotal');
        const previewTax = document.getElementById('previewTax');
        const previewTaxItem = document.getElementById('previewTaxItem');
        const previewTotalCost = document.getElementById('previewTotalCost');
        const previewIncludedServices = document.getElementById('previewIncludedServices');
        const previewExcludedServices = document.getElementById('previewExcludedServices');
        const previewRecommendations = document.getElementById('previewRecommendations');
        
        const previewAdditionalServicesSection = document.getElementById('previewAdditionalServicesSection');
        const previewAdditionalServicesList = document.getElementById('previewAdditionalServicesList');
        
        const taxRate = 0.18;
        
        function addService() {
            const serviceDiv = document.createElement('div');
            serviceDiv.className = 'additional-service';
            serviceDiv.innerHTML = `
                <input type="text" placeholder="Descripción del servicio adicional" class="service-desc">
                <div class="input-group">
                    <div class="currency">S/</div>
                    <input type="number" min="0" step="0.01" value="0.00" class="currency-input service-cost">
                </div>
                <button type="button" class="remove-service-btn" onclick="removeService(this)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            additionalServicesContainer.appendChild(serviceDiv);
            
            const costInput = serviceDiv.querySelector('.service-cost');
            const descInput = serviceDiv.querySelector('.service-desc');
            
            costInput.addEventListener('input', calculateCosts);
            descInput.addEventListener('input', updatePreviewServices);
            
            calculateCosts();
        }
        
        function removeService(button) {
            button.parentElement.remove();
            calculateCosts();
            updatePreviewServices();
        }
        
        function getAdditionalServices() {
            const services = [];
            const serviceElements = additionalServicesContainer.querySelectorAll('.additional-service');
            
            serviceElements.forEach(element => {
                const desc = element.querySelector('.service-desc').value;
                const cost = parseFloat(element.querySelector('.service-cost').value) || 0;
                
                if (desc.trim() !== '') {
                    services.push({
                        description: desc.trim(),
                        cost: cost
                    });
                }
            });
            
            return services;
        }
        
        function calculateCosts() {
            const costPerPerson = parseFloat(costPerPassenger.value) || 0;
            const numPassengers = parseInt(passengers.value) || 0;
            const discountPercent = parseFloat(discount.value) || 0;
            const additionalServices = getAdditionalServices();
            
            let baseCost = costPerPerson * numPassengers;
            let additionalCost = additionalServices.reduce((sum, service) => sum + service.cost, 0);
            let discountAmount = baseCost * (discountPercent / 100);
            let subtotal = baseCost + additionalCost - discountAmount;
            
            let taxAmount = 0;
            let totalCost = subtotal;
            
            if (includeIgv.checked) {
                taxAmount = subtotal * taxRate;
                totalCost = subtotal + taxAmount;
            }
            
            baseCostEl.textContent = `S/ ${baseCost.toFixed(2)}`;
            additionalServicesCostEl.textContent = `S/ ${additionalCost.toFixed(2)}`;
            discountDisplayEl.textContent = `S/ ${discountAmount.toFixed(2)}`;
            taxCostEl.textContent = `S/ ${taxAmount.toFixed(2)}`;
            totalCostEl.textContent = `S/ ${totalCost.toFixed(2)}`;
            
            if (includeIgv.checked) {
                taxItem.style.display = 'flex';
            } else {
                taxItem.style.display = 'none';
            }
            
            if (additionalCost > 0) {
                additionalServicesCostItem.style.display = 'flex';
            } else {
                additionalServicesCostItem.style.display = 'none';
            }
            
            return {
                baseCost,
                additionalCost,
                discountAmount,
                subtotal,
                taxAmount,
                totalCost
            };
        }
        
        function showPreview() {
            if (!clientName.value || !serviceType.value || !startDate.value || !endDate.value) {
                alert('Por favor, complete todos los campos requeridos.');
                return;
            }
            
            const costs = calculateCosts();
            
            // Llenar datos del cliente
            document.getElementById('previewClientNameSimple').textContent = clientName.value || 'No especificado';
            document.getElementById('previewClientEmailSimple').textContent = clientEmail.value || 'No especificado';
            document.getElementById('previewClientPhoneSimple').textContent = clientPhone.value || 'No especificado';
            document.getElementById('previewClientDniSimple').textContent = clientDni.value || 'No especificado';
            document.getElementById('previewClientAddressSimple').textContent = clientAddress.value || 'No especificado';
            
            // Llenar datos del servicio
            document.getElementById('previewServiceTypeSimple').textContent = getServiceTypeText(serviceType.value);
            document.getElementById('previewVehicleTypeSimple').textContent = getVehicleTypeText(vehicleType.value);
            document.getElementById('previewStartDateSimple').textContent = formatDate(startDate.value);
            document.getElementById('previewEndDateSimple').textContent = formatDate(endDate.value);
            document.getElementById('previewDestinationSimple').textContent = destination.value || 'Por definir';
            
            // Llenar datos de costos
            document.getElementById('previewBaseCostSimple').textContent = `S/ ${costs.baseCost.toFixed(2)}`;
            document.getElementById('previewPassengersSimple').textContent = passengers.value;
            document.getElementById('previewDiscountSimple').textContent = `${discount.value}%`;
            document.getElementById('previewIgvSimple').textContent = includeIgv.checked ? 'Incluido (18%)' : 'No incluido';
            document.getElementById('previewTotalCostSimple').textContent = `S/ ${costs.totalCost.toFixed(2)}`;
            
            // Mostrar servicios adicionales si existen
            const additionalServices = getAdditionalServices();
            const additionalSection = document.getElementById('additionalServicesPreviewSection');
            const additionalList = document.getElementById('additionalServicesPreviewList');
            
            if (additionalServices.length > 0) {
                additionalSection.style.display = 'block';
                additionalList.innerHTML = '';
                
                additionalServices.forEach(service => {
                    const serviceItem = document.createElement('div');
                    serviceItem.className = 'service-item-preview';
                    serviceItem.innerHTML = `
                        <span>${service.description}</span>
                        <span class="cost">S/ ${service.cost.toFixed(2)}</span>
                    `;
                    additionalList.appendChild(serviceItem);
                });
            } else {
                additionalSection.style.display = 'none';
            }
            
            // Mostrar vista previa
            pdfPreview.classList.remove('hidden');
            pdfPreview.scrollIntoView({ behavior: 'smooth' });
            
            // Configurar botón de generar PDF desde vista previa
            document.getElementById('generateFromPreviewBtn').onclick = generatePDF;
        }

        function closePreview() {
            pdfPreview.classList.add('hidden');
        }
        
        function updatePreviewServices() {
            const additionalServices = getAdditionalServices();
            
            previewAdditionalServicesList.innerHTML = '';
            
            if (additionalServices.length > 0) {
                previewAdditionalServicesSection.style.display = 'block';
                
                additionalServices.forEach(service => {
                    const serviceItem = document.createElement('div');
                    serviceItem.className = 'additional-service-item';
                    serviceItem.innerHTML = `
                        <div class="additional-service-desc">${service.description}</div>
                        <div class="additional-service-cost">S/ ${service.cost.toFixed(2)}</div>
                    `;
                    previewAdditionalServicesList.appendChild(serviceItem);
                });
            } else {
                previewAdditionalServicesSection.style.display = 'none';
            }
        }
        
        function updateServiceDetails() {
            previewIncludedServices.innerHTML = '';
            previewExcludedServices.innerHTML = '';
            previewRecommendations.innerHTML = '';
            
            const includedList = includedServices.value.split('\n').filter(item => item.trim() !== '');
            includedList.forEach(service => {
                const li = document.createElement('li');
                li.textContent = service.trim();
                previewIncludedServices.appendChild(li);
            });
            
            const excludedList = excludedServices.value.split('\n').filter(item => item.trim() !== '');
            excludedList.forEach(service => {
                const li = document.createElement('li');
                li.textContent = service.trim();
                previewExcludedServices.appendChild(li);
            });
            
            const recList = recommendations.value.split('\n').filter(item => item.trim() !== '');
            recList.forEach(rec => {
                const p = document.createElement('p');
                p.textContent = `• ${rec.trim()}`;
                previewRecommendations.appendChild(p);
            });
        }
        
        async function generatePDF() {
            if (!clientName.value || !serviceType.value || !startDate.value || !endDate.value) {
                alert('Por favor, complete todos los campos requeridos antes de generar el PDF.');
                return;
            }
            
            const doc = new jsPDF();
            const logoPath = 'assets/logo.png';
            
            // Colores corporativos mejorados
            const azulOscuro = [26, 54, 93];
            const azulMedio = [45, 55, 72];
            const dorado = [212, 175, 55];
            const doradoClaro = [234, 209, 130];
            const gris = [100, 100, 100];
            const grisClaro = [245, 245, 245];
            const verde = [56, 161, 105];
            const rojo = [229, 62, 62];
            const blanco = [255, 255, 255];
            
            // Generar numero de cotizacion
            const quoteNum = new Date().getFullYear().toString().slice(-2) + 
                        (new Date().getMonth()+1).toString().padStart(2, '0') + 
                        new Date().getDate().toString().padStart(2, '0') + 
                        Math.floor(Math.random() * 10000).toString().padStart(4, '0');
            
            const img = new Image();
            img.src = logoPath;
            
            img.onload = function() {
                // ============================================
                // PAGINA 1: PORTADA Y DATOS PRINCIPALES
                // ============================================
                
                let y = 20;
                
                // Fondo azul superior
                doc.setFillColor(...azulOscuro);
                doc.rect(0, 0, 210, 70, 'F');
                
                // Franja dorada
                doc.setFillColor(...dorado);
                doc.rect(0, 70, 210, 3, 'F');
                
                // Logo circular con fondo blanco
                doc.setFillColor(...blanco);
                doc.circle(35, 35, 18, 'F');
                doc.setDrawColor(...dorado);
                doc.setLineWidth(1.5);
                doc.circle(35, 35, 18, 'S');
                doc.addImage(img, 'PNG', 20, 20, 30, 30);
                
                // Titulo centrado
                doc.setTextColor(...blanco);
                doc.setFontSize(26);
                doc.setFont(undefined, 'bold');
                doc.text('C tours E.I.R.L', 105, 30, { align: 'center' });
                
                doc.setFontSize(11);
                doc.setFont(undefined, 'normal');
                doc.text('Agencia de Viajes y Transporte de Turismo', 105, 38, { align: 'center' });
                
                // Linea separadora
                doc.setDrawColor(...blanco);
                doc.setLineWidth(0.3);
                doc.line(70, 42, 140, 42);
                
                // Datos de contacto
                doc.setFontSize(8);
                const contactos = [
                    'Portal Constitución 9 - Oficina 3, Ayacucho',
                    '+51 992 248 858 | agenciactours@gmail.com',
                    'www.agenciactours.com'
                ];
                let yContact = 48;
                contactos.forEach(texto => {
                    doc.text(texto, 105, yContact, { align: 'center' });
                    yContact += 4;
                });
                
                // CODIGO QR - Solo en pagina 1, redirige a la web
                const qrURL = 'https://www.agenciactours.com';

                // 1. Crear contenedor temporal
                const qrContainer = document.createElement('div');
                qrContainer.style.position = 'absolute';
                qrContainer.style.left = '-9999px';
                qrContainer.id = 'tempQRContainer';
                document.body.appendChild(qrContainer);

                try {
                    // 2. Generar QR SIN setTimeout
                    new QRCode(qrContainer, {
                        text: qrURL,
                        width: 100,
                        height: 100,
                        colorDark: "#1a365d",
                        colorLight: "#ffffff",
                        correctLevel: QRCode.CorrectLevel.M
                    });
                    
                    // 3. Obtener canvas inmediatamente (ya debería estar listo)
                    const qrCanvas = qrContainer.querySelector('canvas');
                    
                    if (qrCanvas) {
                        const qrImage = qrCanvas.toDataURL('image/png');
                        
                        // 4. Dibujar en PÁGINA 1 (donde estamos actualmente)
                        // Fondo blanco para QR
                        doc.setFillColor(...blanco);
                        doc.roundedRect(163, 8, 40, 40, 3, 3, 'F');
                        
                        // Borde dorado
                        doc.setDrawColor(...dorado);
                        doc.setLineWidth(1.5);
                        doc.roundedRect(163, 8, 40, 40, 3, 3, 'S');
                        
                        // QR
                        doc.addImage(qrImage, 'PNG', 166, 11, 34, 34);
                        
                        // Texto completo en 3 líneas
                        doc.setFontSize(6);
                        doc.setTextColor(...blanco);
                        doc.setFont(undefined, 'italic');
                        doc.text('Visita nuestra web', 183, 54, { align: 'center' });
                        
                        // Línea decorativa
                        doc.setDrawColor(...doradoClaro);
                        doc.setLineWidth(0.3);
                        doc.line(170, 47, 196, 47);
                    }
                    
                    // 5. Limpiar contenedor
                    if (document.getElementById('tempQRContainer')) {
                        document.body.removeChild(qrContainer);
                    }
                    
                } catch (error) {
                    console.warn('Error QR:', error);
                    // Limpiar contenedor si hay error
                    if (document.getElementById('tempQRContainer')) {
                        document.body.removeChild(qrContainer);
                    }
                }
                
                y = 85;
                
                // Titulo principal
                doc.setFillColor(...dorado);
                doc.roundedRect(15, y, 180, 20, 3, 3, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(18);
                doc.setFont(undefined, 'bold');
                doc.text('COTIZACIÓN DE SERVICIOS', 105, y + 8, { align: 'center' });
                
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text('Transporte y Movilización Turística', 105, y + 15, { align: 'center' });
                
                y += 30;
                
                // Info de cotizacion
                doc.setFillColor(...grisClaro);
                doc.roundedRect(15, y, 180, 18, 2, 2, 'F');
                
                doc.setTextColor(...azulOscuro);
                doc.setFontSize(9);
                doc.setFont(undefined, 'bold');
                
                const fecha = new Date().toLocaleDateString('es-ES', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                
                doc.text('N° Cotización:', 20, y + 6);
                doc.setFont(undefined, 'normal');
                doc.text(quoteNum, 50, y + 6);
                
                doc.setFont(undefined, 'bold');
                doc.text('Fecha:', 20, y + 12);
                doc.setFont(undefined, 'normal');
                doc.text(fecha, 50, y + 12);
                
                doc.setFont(undefined, 'bold');
                doc.text('Validez:', 120, y + 6);
                doc.setFont(undefined, 'normal');
                doc.text('15 días calendario', 137, y + 6);
                
                doc.setFont(undefined, 'bold');
                doc.text('Estado:', 120, y + 12);
                doc.setFont(undefined, 'normal');
                doc.setTextColor(...verde);
                doc.text('VIGENTE', 137, y + 12);
                
                y += 28;
                
                // INFORMACION DEL CLIENTE
                doc.setFillColor(...azulOscuro);
                doc.roundedRect(15, y, 180, 10, 2, 2, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(11);
                doc.setFont(undefined, 'bold');
                doc.text('INFORMACIÓN DEL CLIENTE', 20, y + 7);
                
                doc.setFillColor(...dorado);
                doc.circle(190, y + 5, 2, 'F');
                
                y += 15;
                
                const clienteData = [
                    ['Nombre/Empresa:', clientName.value || 'No especificado'],
                    ['Email:', clientEmail.value || 'No especificado'],
                    ['Teléfono:', clientPhone.value || 'No especificado'],
                    ['DNI/Pasaporte:', clientDni.value || 'No especificado'],
                    ['Dirección:', clientAddress.value || 'No especificado']
                ];
                
                clienteData.forEach((row, index) => {
                    if (index % 2 === 0) {
                        doc.setFillColor(...grisClaro);
                        doc.roundedRect(15, y - 1, 180, 7, 1, 1, 'F');
                    }
                    
                    doc.setTextColor(...azulOscuro);
                    doc.setFontSize(9);
                    doc.setFont(undefined, 'bold');
                    doc.text(row[0], 20, y + 3.5);
                    
                    doc.setFont(undefined, 'normal');
                    doc.setTextColor(...gris);
                    const textoValor = doc.splitTextToSize(row[1], 110);
                    doc.text(textoValor, 60, y + 3.5);
                    
                    y += 7;
                });
                
                y += 8;
                
                // DETALLES DEL SERVICIO
                doc.setFillColor(...azulOscuro);
                doc.roundedRect(15, y, 180, 10, 2, 2, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(11);
                doc.setFont(undefined, 'bold');
                doc.text('DETALLES DEL SERVICIO', 20, y + 7);
                
                doc.setFillColor(...dorado);
                doc.circle(190, y + 5, 2, 'F');
                
                y += 15;
                
                const servicioData = [
                    ['Tipo:', getServiceTypeText(serviceType.value)],
                    ['Vehículo:', getVehicleTypeText(vehicleType.value)],
                    ['Inicio:', formatDate(startDate.value)],
                    ['Fin:', formatDate(endDate.value)],
                    ['Destino:', destination.value || 'Por definir'],
                    ['Pasajeros:', passengers.value + ' persona(s)']
                ];
                
                servicioData.forEach((row, index) => {
                    if (index % 2 === 0) {
                        doc.setFillColor(...grisClaro);
                        doc.roundedRect(15, y - 1, 180, 7, 1, 1, 'F');
                    }
                    
                    doc.setTextColor(...azulOscuro);
                    doc.setFontSize(9);
                    doc.setFont(undefined, 'bold');
                    doc.text(row[0], 20, y + 3.5);
                    
                    doc.setFont(undefined, 'normal');
                    doc.setTextColor(...gris);
                    const textoValor = doc.splitTextToSize(row[1], 110);
                    doc.text(textoValor, 60, y + 3.5);
                    
                    y += 7;
                });
                
                // Pie pagina 1
                doc.setFillColor(...azulOscuro);
                doc.rect(0, 277, 210, 20, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(8);
                doc.text('C tours E.I.R.L | RUC: 20603243251 | www.agenciactours.com', 105, 285, { align: 'center' });
                doc.setFontSize(7);
                doc.text('Pág. 1 de 3', 195, 291, { align: 'right' });
                doc.text(quoteNum, 15, 291);
                
                // ============================================
                // PAGINA 2: COSTOS Y SERVICIOS
                // ============================================
                doc.addPage();
                y = 20;
                
                // Encabezado pagina 2
                doc.setFillColor(...azulOscuro);
                doc.rect(0, 0, 210, 35, 'F');
                doc.setFillColor(...dorado);
                doc.rect(0, 35, 210, 2, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(20);
                doc.setFont(undefined, 'bold');
                doc.text('C tours E.I.R.L', 105, 20, { align: 'center' });
                doc.setFontSize(9);
                doc.setFont(undefined, 'normal');
                doc.text('Desglose de Costos', 105, 28, { align: 'center' });
                
                y = 50;
                
                const costs = calculateCosts();
                const additionalServices = getAdditionalServices();
                
                // SERVICIOS ADICIONALES
                if (additionalServices.length > 0) {
                    doc.setFillColor(...azulOscuro);
                    doc.roundedRect(15, y, 180, 10, 2, 2, 'F');
                    
                    doc.setTextColor(...blanco);
                    doc.setFontSize(11);
                    doc.setFont(undefined, 'bold');
                    doc.text('SERVICIOS ADICIONALES', 20, y + 7);
                    
                    doc.setFillColor(...dorado);
                    doc.circle(190, y + 5, 2, 'F');
                    
                    y += 15;
                    
                    additionalServices.forEach((service, index) => {
                        if (index % 2 === 0) {
                            doc.setFillColor(...grisClaro);
                            doc.roundedRect(15, y - 1, 180, 7, 1, 1, 'F');
                        }
                        
                        doc.setTextColor(...gris);
                        doc.setFontSize(9);
                        doc.setFont(undefined, 'normal');
                        const desc = doc.splitTextToSize(service.description, 135);
                        doc.text(desc, 20, y + 3.5);
                        
                        doc.setFont(undefined, 'bold');
                        doc.setTextColor(...dorado);
                        doc.text(`S/ ${service.cost.toFixed(2)}`, 190, y + 3.5, { align: 'right' });
                        
                        y += 7;
                    });
                    
                    y += 10;
                }
                
                // DESGLOSE DE COSTOS
                doc.setFillColor(...azulOscuro);
                doc.roundedRect(15, y, 180, 10, 2, 2, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(11);
                doc.setFont(undefined, 'bold');
                doc.text('RESUMEN DE COSTOS', 20, y + 7);
                
                doc.setFillColor(...dorado);
                doc.circle(190, y + 5, 2, 'F');
                
                y += 15;
                
                const costosDetalle = [
                    ['Costo por Pasajero:', `S/ ${parseFloat(costPerPassenger.value || 0).toFixed(2)}`],
                    ['Pasajeros:', `${passengers.value} persona(s)`],
                    ['Subtotal Base:', `S/ ${costs.baseCost.toFixed(2)}`]
                ];
                
                if (costs.additionalCost > 0) {
                    costosDetalle.push(['Servicios Adicionales:', `S/ ${costs.additionalCost.toFixed(2)}`]);
                }
                
                if (costs.discountAmount > 0) {
                    costosDetalle.push(['Descuento:', `- S/ ${costs.discountAmount.toFixed(2)}`]);
                }
                
                costosDetalle.push(['Subtotal:', `S/ ${costs.subtotal.toFixed(2)}`]);
                
                if (includeIgv.checked) {
                    costosDetalle.push(['IGV (18%):', `S/ ${costs.taxAmount.toFixed(2)}`]);
                }
                
                costosDetalle.forEach((row, index) => {
                    if (index % 2 === 0) {
                        doc.setFillColor(...grisClaro);
                        doc.roundedRect(15, y - 1, 180, 7, 1, 1, 'F');
                    }
                    
                    doc.setTextColor(...gris);
                    doc.setFontSize(9);
                    doc.setFont(undefined, 'normal');
                    doc.text(row[0], 20, y + 3.5);
                    
                    doc.setFont(undefined, 'bold');
                    doc.setTextColor(...azulOscuro);
                    doc.text(row[1], 190, y + 3.5, { align: 'right' });
                    
                    y += 7;
                });
                
                y += 5;
                
                // TOTAL
                doc.setFillColor(...dorado);
                doc.roundedRect(15, y, 180, 14, 2, 2, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('TOTAL A PAGAR:', 20, y + 9);
                doc.setFontSize(16);
                doc.text(`S/ ${costs.totalCost.toFixed(2)}`, 190, y + 9, { align: 'right' });
                
                y += 22;

                // ============================================
                // VERIFICAR SI HAY CONTENIDO PARA PÁGINA 3
                // ============================================
                const includedList = includedServices.value.split('\n').filter(item => item.trim() !== '');
                const excludedList = excludedServices.value.split('\n').filter(item => item.trim() !== '');
                const recList = recommendations.value.split('\n').filter(item => item.trim() !== '');

                const hasServicesOrRecommendations = includedList.length > 0 || excludedList.length > 0 || recList.length > 0;

                // ============================================
                // PIE DE PÁGINA 2
                // ============================================
                doc.setFillColor(...azulOscuro);
                doc.rect(0, 277, 210, 20, 'F');

                doc.setTextColor(...blanco);
                doc.setFontSize(8);
                doc.text('C tours E.I.R.L | RUC: 20603243251 | www.agenciactours.com', 105, 285, { align: 'center' });
                doc.setFontSize(7);

                // Ajustar número de página según si existe página 3 o no
                if (hasServicesOrRecommendations) {
                    doc.text('Pág. 2 de 4', 195, 291, { align: 'right' });
                } else {
                    doc.text('Pág. 2 de 3', 195, 291, { align: 'right' });
                }
                doc.text(quoteNum, 15, 291);

                // ============================================
                // PÁGINA 3: SERVICIOS Y RECOMENDACIONES (SOLO SI HAY CONTENIDO)
                // ============================================
                if (hasServicesOrRecommendations) {
                    doc.addPage();
                    y = 20;
                    
                    // Encabezado página 3
                    doc.setFillColor(...azulOscuro);
                    doc.rect(0, 0, 210, 35, 'F');
                    doc.setFillColor(...dorado);
                    doc.rect(0, 35, 210, 2, 'F');
                    
                    doc.setTextColor(...blanco);
                    doc.setFontSize(20);
                    doc.setFont(undefined, 'bold');
                    doc.text('C tours E.I.R.L', 105, 20, { align: 'center' });
                    doc.setFontSize(9);
                    doc.setFont(undefined, 'normal');
                    doc.text('Servicios y Recomendaciones', 105, 28, { align: 'center' });
                    
                    y = 50;
                    
                    // SERVICIOS INCLUIDOS Y NO INCLUIDOS (solo si hay al menos uno)
                    if (includedList.length > 0 || excludedList.length > 0) {
                        doc.setFillColor(...azulOscuro);
                        doc.roundedRect(15, y, 180, 10, 2, 2, 'F');
                        
                        doc.setTextColor(...blanco);
                        doc.setFontSize(11);
                        doc.setFont(undefined, 'bold');
                        doc.text('SERVICIOS INCLUIDOS Y EXCLUIDOS', 20, y + 7);
                        
                        doc.setFillColor(...dorado);
                        doc.circle(190, y + 5, 2, 'F');
                        
                        y += 15;
                        
                        // Dos columnas ordenadas
                        let yIncluidos = y;
                        let yExcluidos = y;
                        
                        // COLUMNA INCLUIDOS
                        if (includedList.length > 0) {
                            doc.setFillColor(240, 255, 240);
                            doc.roundedRect(15, yIncluidos - 2, 85, 8, 1, 1, 'F');
                            
                            doc.setFontSize(10);
                            doc.setFont(undefined, 'bold');
                            doc.setTextColor(...verde);
                            doc.text('Incluidos:', 20, yIncluidos + 3.5);
                            
                            yIncluidos += 10;
                            
                            doc.setFontSize(8);
                            doc.setFont(undefined, 'normal');
                            doc.setTextColor(...gris);
                            
                            includedList.forEach(item => {
                                const lines = doc.splitTextToSize(`• ${item.trim()}`, 75);
                                doc.text(lines, 20, yIncluidos);
                                yIncluidos += lines.length * 4;
                            });
                        }
                        
                        // COLUMNA EXCLUIDOS
                        if (excludedList.length > 0) {
                            doc.setFillColor(255, 240, 240);
                            doc.roundedRect(110, yExcluidos - 2, 85, 8, 1, 1, 'F');
                            
                            doc.setFontSize(10);
                            doc.setFont(undefined, 'bold');
                            doc.setTextColor(...rojo);
                            doc.text('No Incluidos:', 115, yExcluidos + 3.5);
                            
                            yExcluidos += 10;
                            
                            doc.setFontSize(8);
                            doc.setFont(undefined, 'normal');
                            doc.setTextColor(...gris);
                            
                            excludedList.forEach(item => {
                                const lines = doc.splitTextToSize(`• ${item.trim()}`, 75);
                                doc.text(lines, 115, yExcluidos);
                                yExcluidos += lines.length * 4;
                            });
                        }
                        
                        y = Math.max(yIncluidos, yExcluidos) + 10;
                    }
                    
                    // RECOMENDACIONES (solo si hay)
                    if (recList.length > 0) {
                        doc.setFillColor(...azulOscuro);
                        doc.roundedRect(15, y, 180, 10, 2, 2, 'F');
                        
                        doc.setTextColor(...blanco);
                        doc.setFontSize(11);
                        doc.setFont(undefined, 'bold');
                        doc.text('RECOMENDACIONES', 20, y + 7);
                        
                        doc.setFillColor(...dorado);
                        doc.circle(190, y + 5, 2, 'F');
                        
                        y += 15;
                        
                        doc.setFontSize(8);
                        doc.setFont(undefined, 'normal');
                        doc.setTextColor(...gris);
                        
                        recList.forEach(rec => {
                            const lines = doc.splitTextToSize(`• ${rec.trim()}`, 170);
                            doc.text(lines, 20, y);
                            y += lines.length * 4;
                        });
                    }
                    
                    // Pie de página 3
                    doc.setFillColor(...azulOscuro);
                    doc.rect(0, 277, 210, 20, 'F');
                    
                    doc.setTextColor(...blanco);
                    doc.setFontSize(8);
                    doc.text('C tours E.I.R.L | RUC: 20603243251 | www.agenciactours.com', 105, 285, { align: 'center' });
                    doc.setFontSize(7);
                    doc.text('Pág. 3 de 4', 195, 291, { align: 'right' });
                    doc.text(quoteNum, 15, 291);
                }
                
                // ============================================
                // PAGINA 4: TERMINOS Y FIRMA
                // ============================================
                doc.addPage();
                y = 20;
                
                // Encabezado pagina 3
                doc.setFillColor(...azulOscuro);
                doc.rect(0, 0, 210, 35, 'F');
                doc.setFillColor(...dorado);
                doc.rect(0, 35, 210, 2, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(20);
                doc.setFont(undefined, 'bold');
                doc.text('C tours E.I.R.L', 105, 20, { align: 'center' });
                doc.setFontSize(9);
                doc.setFont(undefined, 'normal');
                doc.text('Términos y Condiciones', 105, 28, { align: 'center' });
                
                y = 50;
                
                // TERMINOS
                doc.setFillColor(...azulOscuro);
                doc.roundedRect(15, y, 180, 10, 2, 2, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(11);
                doc.setFont(undefined, 'bold');
                doc.text('TÉRMINOS Y CONDICIONES', 20, y + 7);
                
                doc.setFillColor(...dorado);
                doc.circle(190, y + 5, 2, 'F');
                
                y += 15;
                
                const terminos = [
                    'VIGENCIA: Válida 15 días desde emisión.',
                    'RESERVA: Se requiere el 50% del monto total como anticipo para confirmar la reserva del servicio.',
                    'PAGO: El 50% restante debera cancelarse antes o al momento de iniciar el servicio contratado.',
                    'VEHÍCULOS: La empresa se reserva el derecho de asignar vehiculos de categoria similar al solicitado.',
                    'MODIFICACIONES: Cualquier cambio en fechas, horarios o itinerario puede generar cargos adicionales.',
                    'CANCELACIONES: Las cancelaciones con menos de 72 horas no tendran devolucion del anticipo pagado.',
                    'SEGURO: Todos nuestros vehiculos cuentan con SOAT vigente y poliza de responsabilidad civil.'
                ];
                
                doc.setFontSize(8);
                doc.setFont(undefined, 'normal');
                doc.setTextColor(...gris);
                
                terminos.forEach((termino, index) => {
                    doc.setFont(undefined, 'bold');
                    doc.setTextColor(...azulOscuro);
                    doc.text(`${index + 1}.`, 20, y);
                    
                    doc.setFont(undefined, 'normal');
                    doc.setTextColor(...gris);
                    const lines = doc.splitTextToSize(termino, 165);
                    doc.text(lines, 26, y);
                    
                    y += 6;
                });
                
                y += 10;
                
                // DATOS BANCARIOS
                doc.setFillColor(...azulOscuro);
                doc.roundedRect(15, y, 180, 10, 2, 2, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(11);
                doc.setFont(undefined, 'bold');
                doc.text('DATOS BANCARIOS', 20, y + 7);
                
                doc.setFillColor(...dorado);
                doc.circle(190, y + 5, 2, 'F');
                
                y += 15;
                
                doc.setFillColor(...grisClaro);
                doc.roundedRect(15, y, 180, 20, 2, 2, 'F');
                
                doc.setTextColor(...azulOscuro);
                doc.setFontSize(9);
                doc.setFont(undefined, 'bold');
                doc.text('RUC:', 20, y + 5);
                doc.setFont(undefined, 'normal');
                doc.text('20603243251', 40, y + 5);
                
                doc.setFont(undefined, 'bold');
                doc.text('Banco:', 20, y + 10);
                doc.setFont(undefined, 'normal');
                doc.text('BCP', 40, y + 10);
                
                doc.setFont(undefined, 'bold');
                doc.text('Cuenta:', 20, y + 15);
                doc.setFont(undefined, 'normal');
                doc.text('[Número de Cuenta]', 40, y + 15);
                
                doc.setFont(undefined, 'bold');
                doc.text('CCI:', 110, y + 5);
                doc.setFont(undefined, 'normal');
                doc.text('[Código CCI]', 125, y + 5);
                
                y += 30;
                
                // MENSAJE
                doc.setFillColor(...dorado);
                doc.roundedRect(15, y, 180, 20, 3, 3, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(13);
                doc.setFont(undefined, 'bold');
                doc.text('Gracias por Confiar en Nosotros', 105, y + 8, { align: 'center' });
                doc.setFontSize(9);
                doc.setFont(undefined, 'normal');
                doc.text('Nos comprometemos a brindarle un servicio seguro, confortable y de calidad,\n estamos a su disposición para cualquier consulta adicional.', 105, y + 14, { align: 'center' });
                
                y += 30;
                
                // FIRMA DEL GERENTE
                doc.setTextColor(...azulOscuro);
                doc.setFontSize(10);
                doc.setFont(undefined, 'bold');
                doc.text('Atentamente,', 105, y, { align: 'center' });
                
                y += 15;
                
                // Linea de firma
                doc.setDrawColor(...azulOscuro);
                doc.setLineWidth(0.5);
                doc.line(75, y, 135, y);
                
                y += 6;
                
                doc.setFontSize(10);
                doc.setFont(undefined, 'bold');
                doc.text('César De la Cruz Vilcapoma', 105, y, { align: 'center' });
                
                y += 5;
                
                doc.setFontSize(9);
                doc.setFont(undefined, 'normal');
                doc.text('Gerente General', 105, y, { align: 'center' });
                
                y += 4;
                
                doc.setFontSize(8);
                doc.text('DNI: 74039078', 105, y, { align: 'center' });
                
                y += 4;
                
                doc.setFont(undefined, 'bold');
                doc.text('RUC: 20603243251', 105, y, { align: 'center' });
                
                // Pie pagina 3
                doc.setFillColor(...azulOscuro);
                doc.rect(0, 277, 210, 20, 'F');
                
                doc.setTextColor(...blanco);
                doc.setFontSize(8);
                doc.text('C tours E.I.R.L | RUC: 20603243251 | www.agenciactours.com', 105, 285, { align: 'center' });
                doc.setFontSize(7);
                // Número de página ajustado según si existe página 3 o no
                if (hasServicesOrRecommendations) {
                    doc.text('Pág. 4 de 4', 195, 291, { align: 'right' });
                } else {
                    doc.text('Pág. 3 de 3', 195, 291, { align: 'right' });
                }
                doc.text(quoteNum, 15, 291);
                
                // GUARDAR PDF
                setTimeout(() => {
                    const pdfBlob = doc.output('blob');
                    const fileName = `Cotizacion_CTours_${quoteNum}.pdf`;
                    
                    currentPdfBlob = pdfBlob;
                    currentPdfName = fileName;
                    
                    sharePdfBtn.classList.remove('hidden');
                    doc.save(fileName);
                    
                    if (navigator.share) {
                        setTimeout(() => {
                            if (confirm('✅ PDF generado exitosamente.\n\nDesea compartirlo ahora?')) {
                                sharePdf();
                            }
                        }, 500);
                    } else {
                        alert('✅ PDF generado exitosamente.');
                    }
                }, 200);
            };
            
            img.onerror = function() {
                alert('Error: No se pudo cargar el logo.');
            };
        }
        
        async function sharePdf() {
            if (!currentPdfBlob || !currentPdfName) {
                alert('Primero debe generar el PDF.');
                return;
            }
            
            try {
                const file = new File([currentPdfBlob], currentPdfName, { type: 'application/pdf' });
                
                if (navigator.share && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        title: 'Cotización C tours E.I.R.L',
                        text: 'Cotización de servicios de movilización',
                        files: [file]
                    });
                    console.log('PDF compartido exitosamente');
                } else if (navigator.share) {
                    const url = URL.createObjectURL(currentPdfBlob);
                    await navigator.share({
                        title: 'Cotización C tours E.I.R.L',
                        text: 'Cotización de servicios de movilización - C tours',
                        url: url
                    });
                    setTimeout(() => URL.revokeObjectURL(url), 60000);
                } else {
                    const url = URL.createObjectURL(currentPdfBlob);
                    const newWindow = window.open(url, '_blank');
                    
                    if (!newWindow) {
                        alert('No se pudo abrir el PDF. Por favor, verifique que su navegador permite ventanas emergentes.');
                    } else {
                        alert('PDF abierto en nueva ventana. Use el menú de su navegador para compartir.');
                    }
                    
                    setTimeout(() => URL.revokeObjectURL(url), 60000);
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    console.log('Compartir cancelado por el usuario');
                } else {
                    console.error('Error al compartir:', error);
                    alert('No se pudo compartir el PDF. El archivo ha sido descargado en su dispositivo.');
                }
            }
        }
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('es-ES', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }
        
        function getServiceTypeText(value) {
            const texts = {
                transfer: 'Transfer Aeropuerto/Hotel',
                city: 'Tour Ciudad',
                intercity: 'Transporte Interurbano',
                school: 'Viaje de Estudios',
                corporate: 'Servicio Corporativo',
                event: 'Transporte para Eventos',
                custom: 'Servicio Personalizado'
            };
            return texts[value] || value;
        }
        
        function getVehicleTypeText(value) {
            const texts = {
                sedan: 'Sedán',
                suv: 'SUV',
                pick: 'Pick Up / Camioneta',
                van: 'Van',
                minivan: 'Mini Van',
                minibus: 'Minibús',
                bus: 'Autobús'
            };
            return texts[value] || value;
        }
        
        costPerPassenger.addEventListener('input', calculateCosts);
        passengers.addEventListener('input', calculateCosts);
        discount.addEventListener('input', calculateCosts);
        includeIgv.addEventListener('change', calculateCosts);
        
        previewBtn.addEventListener('click', showPreview);
        generatePdfBtn.addEventListener('click', generatePDF);
        sharePdfBtn.addEventListener('click', sharePdf);
        
        resetBtn.addEventListener('click', function() {
            if (confirm('¿Está seguro de que desea limpiar el formulario? Se perderán todos los datos.')) {
                clientName.value = '';
                clientEmail.value = '';
                clientPhone.value = '';
                clientDni.value = '';
                clientAddress.value = '';
                serviceType.value = 'transfer';
                vehicleType.value = 'sedan';
                startDate.value = '';
                endDate.value = '';
                destination.value = '';
                costPerPassenger.value = '0.00';
                passengers.value = '1';
                discount.value = '0';
                includeIgv.checked = true;
                includedServices.value = '';
                excludedServices.value = '';
                recommendations.value = '';
                
                additionalServicesContainer.innerHTML = '';
                
                pdfPreview.classList.add('hidden');
                sharePdfBtn.classList.add('hidden');
                currentPdfBlob = null;
                currentPdfName = null;
                calculateCosts();
            }
        });
        
        const today = new Date().toISOString().split('T')[0];
        startDate.min = today;
        endDate.min = today;
        
        calculateCosts();
    </script>

    <script>
        // Script de precarga
        window.addEventListener('load', function() {
            const preloader = document.getElementById('preloader');
            
            // Esperar 2 segundos y luego ocultar la precarga
            setTimeout(function() {
                preloader.classList.add('fade-out');
                
                // Remover completamente del DOM después de la animación
                setTimeout(function() {
                    preloader.style.display = 'none';
                }, 500);
            }, 2000);
        });

        // ========== MODAL ACERCA DE ==========
        const aboutBtn = document.getElementById('aboutBtn');
        const aboutModal = document.getElementById('aboutModal');
        const closeModal = document.getElementById('closeModal');

        // Abrir modal
        aboutBtn.addEventListener('click', function() {
            aboutModal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // Prevenir scroll
        });

        // Cerrar modal con la X
        closeModal.addEventListener('click', function() {
            aboutModal.classList.add('hidden');
            document.body.style.overflow = 'auto'; // Restaurar scroll
        });

        // Cerrar modal al hacer clic fuera
        aboutModal.addEventListener('click', function(e) {
            if (e.target === aboutModal) {
                aboutModal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }
        });

        // Cerrar modal con la tecla ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && !aboutModal.classList.contains('hidden')) {
                aboutModal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }
        });
    </script>
</body>
</html>
